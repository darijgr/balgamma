\documentclass[numbers=enddot,12pt,final,onecolumn,notitlepage]{scrartcl}%
\usepackage[headsepline,footsepline,manualmark]{scrlayer-scrpage}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{framed}
\usepackage{comment}
\usepackage{color}
\usepackage[breaklinks=True]{hyperref}
\usepackage[sc]{mathpazo}
\usepackage[T1]{fontenc}
\usepackage{needspace}
\usepackage{tabls}
\usepackage{tikz}
%TCIDATA{OutputFilter=latex2.dll}
%TCIDATA{Version=5.50.0.2960}
%TCIDATA{LastRevised=Sunday, July 13, 2025 21:03:51}
%TCIDATA{SuppressPackageManagement}
%TCIDATA{<META NAME="GraphicsSave" CONTENT="32">}
%TCIDATA{<META NAME="SaveForMode" CONTENT="1">}
%TCIDATA{BibliographyScheme=Manual}
%TCIDATA{Language=American English}
%BeginMSIPreambleData
\providecommand{\U}[1]{\protect\rule{.1in}{.1in}}
%EndMSIPreambleData
\theoremstyle{definition}
\newtheorem{theo}{Theorem}[section]
\newenvironment{theorem}[1][]
{\begin{theo}[#1]\begin{leftbar}}
{\end{leftbar}\end{theo}}
\newtheorem{lem}[theo]{Lemma}
\newenvironment{lemma}[1][]
{\begin{lem}[#1]\begin{leftbar}}
{\end{leftbar}\end{lem}}
\newtheorem{prop}[theo]{Proposition}
\newenvironment{proposition}[1][]
{\begin{prop}[#1]\begin{leftbar}}
{\end{leftbar}\end{prop}}
\newtheorem{defi}[theo]{Definition}
\newenvironment{definition}[1][]
{\begin{defi}[#1]\begin{leftbar}}
{\end{leftbar}\end{defi}}
\newtheorem{remk}[theo]{Remark}
\newenvironment{remark}[1][]
{\begin{remk}[#1]\begin{leftbar}}
{\end{leftbar}\end{remk}}
\newtheorem{coro}[theo]{Corollary}
\newenvironment{corollary}[1][]
{\begin{coro}[#1]\begin{leftbar}}
{\end{leftbar}\end{coro}}
\newtheorem{conv}[theo]{Convention}
\newenvironment{convention}[1][]
{\begin{conv}[#1]\begin{leftbar}}
{\end{leftbar}\end{conv}}
\newtheorem{quest}[theo]{Question}
\newenvironment{question}[1][]
{\begin{quest}[#1]\begin{leftbar}}
{\end{leftbar}\end{quest}}
\newtheorem{warn}[theo]{Warning}
\newenvironment{warning}[1][]
{\begin{warn}[#1]\begin{leftbar}}
{\end{leftbar}\end{warn}}
\newtheorem{conj}[theo]{Conjecture}
\newenvironment{conjecture}[1][]
{\begin{conj}[#1]\begin{leftbar}}
{\end{leftbar}\end{conj}}
\newtheorem{exam}[theo]{Example}
\newenvironment{example}[1][]
{\begin{exam}[#1]\begin{leftbar}}
{\end{leftbar}\end{exam}}
\newenvironment{statement}{\begin{quote}}{\end{quote}}
\newenvironment{fineprint}{\begin{small}}{\end{small}}
\iffalse
\newenvironment{proof}[1][Proof]{\noindent\textbf{#1.} }{\ \rule{0.5em}{0.5em}}
\newenvironment{convention}[1][Convention]{\noindent\textbf{#1.} }{\ \rule{0.5em}{0.5em}}
\newenvironment{question}[1][Question]{\noindent\textbf{#1.} }{\ \rule{0.5em}{0.5em}}
\newenvironment{warning}[1][Warning]{\noindent\textbf{#1.} }{\ \rule{0.5em}{0.5em}}
\fi
\let\sumnonlimits\sum
\let\prodnonlimits\prod
\let\cupnonlimits\bigcup
\let\capnonlimits\bigcap
\renewcommand{\sum}{\sumnonlimits\limits}
\renewcommand{\prod}{\prodnonlimits\limits}
\renewcommand{\bigcup}{\cupnonlimits\limits}
\renewcommand{\bigcap}{\capnonlimits\limits}
\setlength\tablinesep{3pt}
\setlength\arraylinesep{3pt}
\setlength\extrarulesep{3pt}
\setlength\textheight{22.5cm}
\setlength\textwidth{14.8cm}
\newenvironment{verlong}{}{}
\newenvironment{vershort}{}{}
\newenvironment{noncompile}{}{}
\excludecomment{verlong}
\includecomment{vershort}
\excludecomment{noncompile}
\newcommand{\defn}[1]{{\color{darkred}\emph{#1}}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\KK}{\mathbb{K}}
\newcommand{\set}[1]{\left\{ #1 \right\}}
\newcommand{\abs}[1]{\left| #1 \right|}
\newcommand{\tup}[1]{\left( #1 \right)}
\newcommand{\ive}[1]{\left[ #1 \right]}
\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\mono}{\hookrightarrow}
\newcommand{\epi}{\twoheadrightarrow}
\newcommand{\iso}{\overset{\cong}{\to}}
\newcommand{\symd}{\mathbin{\bigtriangleup}}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{calc}
\usetikzlibrary{chains}
\usetikzlibrary{shapes}
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{lindenmayersystems}
\definecolor{darkgreen}{rgb}{0,.5,0}
\newtheoremstyle{plainsl}
{8pt plus 2pt minus 4pt}
{8pt plus 2pt minus 4pt}
{\slshape}
{0pt}
{\bfseries}
{.}
{5pt plus 1pt minus 1pt}
{}
\theoremstyle{plainsl}
\ihead{An equality for balanced digraphs, version \today}
\ohead{page \thepage}
\cfoot{}
\begin{document}

\title{An equality for balanced digraphs}
\author{Darij Grinberg\thanks{Drexel University, Philadelphia, PA.
\href{mailto:darijgrinberg@gmail.com}{\texttt{darijgrinberg@gmail.com}}},
Benjamin Liber\thanks{Drexel University, Philadelphia, PA.
\href{mailto:bl839@drexel.edu}{\texttt{bl839@drexel.edu}}}}
\date{ROUGH DRAFT, \today}
\maketitle

\begin{abstract}
Consider a directed multigraph $D$ that is balanced (i.e., at each vertex, the
indegree equals the outdegree). Let $A$ be its set of arcs. Fix an integer
$k\in\mathbb{N}$. Let $s$ be a vertex of $D$. We show that the number of
$k$-element subsets $B$ of $A$ that contain no cycles but contain a path from
each vertex to $s$ (we call them \textquotedblleft$s$%
-convergences\textquotedblright) is independent on $s$. This generalizes known
facts about spanning arborescences and about acyclic orientations.

\end{abstract}

\section{The theorem}

In this note, we shall discuss \emph{balanced multidigraphs} -- i.e., directed
multigraphs (allowing loops and multiple arcs) in which each vertex satisfies
\textquotedblleft outdegree = indegree\textquotedblright. We recall the
relevant definitions in more detail: A \emph{multidigraph} (henceforth just
\emph{digraph}) means a triple $\left(  V,A,\psi\right)  $, where $V$ and $A$
are two finite sets and $\psi:A\rightarrow V\times V$ is a map. The elements
of $V$ are called the \emph{vertices} of this digraph; the elements $A$ its
\emph{arcs}. The \emph{source} and the \emph{target} of an arc $a\in A$ are
the first and second entries of the pair $\psi\left(  a\right)  $. The
\emph{indegree} $\deg^{-}v$ of a vertex $v\in V$ means the number of arcs
$a\in A$ whose target is $v$. The \emph{outdegree} $\deg^{+}v$ of a vertex
$v\in V$ means the number of arcs $a\in A$ whose source is $v$. We say that a
digraph $\left(  V,A,\psi\right)  $ is \emph{balanced} if and only if each
vertex $v\in V$ satisfies $\deg^{+}v=\deg^{-}v$. For further terminology on
digraphs, we refer to \cite{22s}.\footnote{The famous directed
Euler--Hierholzer theorem (which will not be used in this note) says that a
weakly connected digraph contains an Eulerian circuit if and only if it is
balanced. Thus, weakly connected balanced digraphs are also known as
\emph{Eulerian digraphs}.}

A \emph{to-root} of a digraph $D$ means a vertex $t$ of $D$ such that for each
vertex $v$ of $D$, the digraph $D$ has a path from $v$ to $t$. (Equivalently:
has a walk from $v$ to $t$.)

From now on, we \textbf{fix a balanced digraph }$D=\left(  V,A,\psi\right)  $.
If $B$ is any subset of $A$, then $D\left\langle B\right\rangle $ will denote
the induced subdigraph $\left(  V,B,\psi\mid_{B}\right)  $ of $D$. A subset
$B$ of $A$ will be called \emph{acyclic} if the subdigraph $D\left\langle
B\right\rangle $ has no (directed) cycles.

Given a vertex $s$ of $D$, we define an $s$\emph{-convergence} to be an
acyclic subset $B$ of $A$ such that $s$ is a to-root of the subdigraph
$D\left\langle B\right\rangle $.

We can think of an $s$-convergence as a set $B$ of arcs of $D$ such that by
following the $B$-arcs (i.e., the arcs in $B$) from any vertex $v\in V$, you
will always eventually end up in $s$ (no matter which $B$-arcs you take), and
you will get stuck in $s$.

For any $k\in\mathbb{N}$ and $s\in V$, we let $\gamma_{k}\left(  s\right)  $
denote the number of $s$-convergences of size $k$ (that is, with $k$ arcs).

In this note, we shall prove the following result:

\begin{theorem}
\label{thm.balgamma}Let $k\in\mathbb{N}$. Then, the number $\gamma_{k}\left(
s\right)  $ does not depend on $s$. In other words, $\gamma_{k}\left(
s\right)  =\gamma_{k}\left(  t\right)  $ for any $s,t\in V$.
\end{theorem}

\begin{example}
Let $D$ be the following balanced multidigraph:%
\[%
%TCIMACRO{\TeXButton{tikz multidigraph}{\begin{tikzpicture}[scale=4]
%\begin{scope}[every node/.style={circle,thick,draw=green!60!black}]
%\node(1) at (0,0) {$1$};
%\node(2) at (0,1) {$2$};
%\node(3) at (1,1) {$3$};
%\node(4) at (1,0) {$4$};
%\end{scope}
%\begin{scope}[every edge/.style={draw=black,very thick}, every loop/.style={}]
%\path[->] (1) edge[bend left=20] node[left] {$a$} (2);
%\path[->] (2) edge[bend left=20] node[right] {$b$} (1);
%\path[->] (2) edge node[above] {$c$} (3);
%\path[->] (3) edge node[right] {$d$} (4);
%\path[->] (4) edge node[above] {$e$} (2);
%\path[->] (1) edge[bend left=20] node[above] {$f$} (4);
%\path[->] (4) edge[bend left=20] node[below] {$g$} (1);
%\end{scope}
%\end{tikzpicture}}}%
%BeginExpansion
\begin{tikzpicture}[scale=4]
\begin{scope}[every node/.style={circle,thick,draw=green!60!black}]
\node(1) at (0,0) {$1$};
\node(2) at (0,1) {$2$};
\node(3) at (1,1) {$3$};
\node(4) at (1,0) {$4$};
\end{scope}
\begin{scope}[every edge/.style={draw=black,very thick}, every loop/.style={}]
\path[->] (1) edge[bend left=20] node[left] {$a$} (2);
\path[->] (2) edge[bend left=20] node[right] {$b$} (1);
\path[->] (2) edge node[above] {$c$} (3);
\path[->] (3) edge node[right] {$d$} (4);
\path[->] (4) edge node[above] {$e$} (2);
\path[->] (1) edge[bend left=20] node[above] {$f$} (4);
\path[->] (4) edge[bend left=20] node[below] {$g$} (1);
\end{scope}
\end{tikzpicture}%
%EndExpansion
\]
Then, the $1$-convergences are the subsets%
\[
\left\{  b,d,g\right\}  ,\ \ \ \ \ \ \ \ \ \ \left\{  b,d,e\right\}
,\ \ \ \ \ \ \ \ \ \ \left\{  c,d,g\right\}  ,\ \ \ \ \ \ \ \ \ \ \left\{
b,d,e,g\right\}  ,\ \ \ \ \ \ \ \ \ \ \left\{  b,c,d,g\right\}  .
\]
Hence, $\gamma_{3}\left(  1\right)  =3$ and $\gamma_{4}\left(  1\right)  =2$
and $\gamma_{k}\left(  1\right)  =0$ for all $k\notin\left\{  3,4\right\}  $.
Theorem \ref{thm.balgamma} says that the same numbers appear if you replace
$1$ by any other vertex.

Here is the spanning subdigraph $D\left\langle B\right\rangle $ for
$B=\left\{  b,d,e,g\right\}  $:%
\[%
%TCIMACRO{\TeXButton{tikz multidigraph}{\begin{tikzpicture}[scale=4]
%\begin{scope}[every node/.style={circle,thick,draw=green!60!black}]
%\node(1) at (0,0) {$1$};
%\node(2) at (0,1) {$2$};
%\node(3) at (1,1) {$3$};
%\node(4) at (1,0) {$4$};
%\end{scope}
%\begin{scope}[every edge/.style={draw=black,very thick}, every loop/.style={}]
%\path[->] (2) edge[bend left=20] node[right] {$b$} (1);
%\path[->] (3) edge node[right] {$d$} (4);
%\path[->] (4) edge node[above] {$e$} (2);
%\path[->] (4) edge[bend left=20] node[below] {$g$} (1);
%\end{scope}
%\end{tikzpicture}}}%
%BeginExpansion
\begin{tikzpicture}[scale=4]
\begin{scope}[every node/.style={circle,thick,draw=green!60!black}]
\node(1) at (0,0) {$1$};
\node(2) at (0,1) {$2$};
\node(3) at (1,1) {$3$};
\node(4) at (1,0) {$4$};
\end{scope}
\begin{scope}[every edge/.style={draw=black,very thick}, every loop/.style={}]
\path[->] (2) edge[bend left=20] node[right] {$b$} (1);
\path[->] (3) edge node[right] {$d$} (4);
\path[->] (4) edge node[above] {$e$} (2);
\path[->] (4) edge[bend left=20] node[below] {$g$} (1);
\end{scope}
\end{tikzpicture}%
%EndExpansion
\]

\end{example}

\section{Particular cases}

Theorem \ref{thm.balgamma} was inspired by a talk of Karla Leipold (NORCOM
2025), which made the first author aware of \cite[Lemma 4.1]{LeiVal24}. While
no enumerative questions were discussed in said talk, a scent of bijection was
noticeable. The present note is the result of following this scent.

Some particular cases of Theorem \ref{thm.balgamma} are known:

\begin{enumerate}
\item When $k=\left\vert V\right\vert -1$, the $s$-convergences are precisely
the spanning arborescences of $D$ rooted to $s$. Indeed, the condition
$\left\vert B\right\vert =\left\vert V\right\vert -1$, combined with the
to-rootness of $s$, forces $D\left\langle B\right\rangle $ to be an
arborescence rooted to $s$ (by \cite[Theorem 5.10.5]{22s}). Thus, in the case
$k=\left\vert V\right\vert -1$, Theorem \ref{thm.balgamma} is just
\cite[Corollary 5.12.1]{22s}.

Likewise, if $k<\left\vert V\right\vert -1$, then Theorem \ref{thm.balgamma}
is just saying that $0=0$, since a spanning subdigraph $D\left\langle
B\right\rangle $ with fewer than $\left\vert V\right\vert -1$ arcs cannot have
a to-root.

\item If $D=G^{\operatorname*{bidir}}$ for some (undirected) multigraph
$G=\left(  V,E,\varphi\right)  $, and if $k=\left\vert E\right\vert
=\left\vert A\right\vert /2$, then the $s$-convergences are just the acyclic
orientations of $G$ with unique sink $s$ (why?). Thus, in this case, Theorem
\ref{thm.balgamma} is saying that the number of acyclic orientations of a
given multigraph $G$ with unique sink $s$ does not depend on $s$. This is a
recent result by Foissy \cite[Proposition 4.6]{Foissy22}.

\item I think \cite[Proposition 3.7]{PerPha15} is Theorem \ref{thm.balgamma}
for the maximum possible $k$ for which $\sum_{s\in V}\gamma_{k}\left(
s\right)  \neq0$. (Check this!)
\end{enumerate}

\section{Proof of the theorem}

Our proof of Theorem \ref{thm.balgamma} uses an idea from the proof of
\cite[Proposition 3.7]{PerPha15}.

For two sets $P$ and $Q$, we shall use the notation $P\sqcup Q$ for the union
$P\cup Q$ if the intersection $P\cap Q$ is empty. If $P\cap Q$ is nonempty,
then writing $P\sqcup Q$ is not allowed. Of course, if $P\sqcup Q$ exists,
then $\left\vert P\sqcup Q\right\vert =\left\vert P\right\vert +\left\vert
Q\right\vert $.

For any subsets $P$ and $Q$ of $V$, we shall let $A\left(  P,Q\right)  $
denote the number of arcs in $A$ whose source belongs to $P$ and whose target
belongs to $Q$. The following fact is simple but crucial:

\begin{proposition}
\label{prop.A-symmetry}Let $P$ and $Q$ be two subsets of $V$ such that
$P\sqcup Q=V$. Then,
\[
\left\vert A\left(  P,Q\right)  \right\vert =\left\vert A\left(  Q,P\right)
\right\vert .
\]

\end{proposition}

\begin{proof}
This is a known fact (see, e.g., \cite[Exercise 9.1]{22s}). The easiest way to
prove it is by observing that%
\[
A\left(  P,V\right)  =A\left(  P,P\right)  \sqcup A\left(  P,Q\right)
\]
(since the target of an arc belongs to either $P$ or $Q$ but not to both), so
that%
\[
\left\vert A\left(  P,V\right)  \right\vert =\left\vert A\left(  P,P\right)
\right\vert +\left\vert A\left(  P,Q\right)  \right\vert .
\]
However, we can count the arcs in $A\left(  P,V\right)  $ according to their
sources $p\in P$. This yields%
\begin{equation}
\left\vert A\left(  P,V\right)  \right\vert =\sum_{p\in P}\deg^{+}p,
\label{pf.prop.A-symmetry.3}%
\end{equation}
since each arc in $A\left(  P,V\right)  $ is counted in the outdegree of
exactly one $p\in P$ (namely, of its source). Comparing these two equalities,
we obtain%
\begin{equation}
\sum_{p\in P}\deg^{+}p=\left\vert A\left(  P,P\right)  \right\vert +\left\vert
A\left(  P,Q\right)  \right\vert . \label{pf.prop.A-symmetry.4}%
\end{equation}


On the other hand, $A\left(  V,P\right)  =A\left(  Q,P\right)  \sqcup A\left(
P,P\right)  $ and thus%
\[
\left\vert A\left(  V,P\right)  \right\vert =\left\vert A\left(  Q,P\right)
\right\vert +\left\vert A\left(  P,P\right)  \right\vert .
\]
However, similarly to (\ref{pf.prop.A-symmetry.3}), we can show that%
\[
\left\vert A\left(  V,P\right)  \right\vert =\sum_{p\in P}\deg^{-}p.
\]
Comparing these two equalities, we obtain%
\begin{equation}
\sum_{p\in P}\deg^{-}p=\left\vert A\left(  Q,P\right)  \right\vert +\left\vert
A\left(  P,P\right)  \right\vert . \label{pf.prop.A-symmetry.5}%
\end{equation}


The left hand sides of the equalities (\ref{pf.prop.A-symmetry.4}) and
(\ref{pf.prop.A-symmetry.5}) are equal (since $D$ is balanced, so that each
$p\in P$ satisfies $\deg^{+}p=\deg^{-}p$). Hence, their right hand sides must
be equal as well. That is,%
\[
\left\vert A\left(  P,P\right)  \right\vert +\left\vert A\left(  P,Q\right)
\right\vert =\left\vert A\left(  Q,P\right)  \right\vert +\left\vert A\left(
P,P\right)  \right\vert .
\]
Subtracting $\left\vert A\left(  P,P\right)  \right\vert $ from this equality,
we obtain $\left\vert A\left(  P,Q\right)  \right\vert =\left\vert A\left(
Q,P\right)  \right\vert $. Thus, Proposition \ref{prop.A-symmetry} is proved.
\end{proof}

Whenever $P$ and $Q$ are two subsets of $V$ satisfying $P\sqcup Q=V$, we
\textbf{fix a bijection} $\phi_{P,Q}:A\left(  P,Q\right)  \rightarrow A\left(
Q,P\right)  $. (Such a bijection exists because Proposition
\ref{prop.A-symmetry} says that the sets $A\left(  P,Q\right)  $ and $A\left(
Q,P\right)  $ have the same size.) There are some more and less natural ways
to choose such bijections, but we content ourselves with any choice, as long
as we leave it fixed.

We shall refer to the bijection $\phi_{P,Q}:A\left(  P,Q\right)  \rightarrow
A\left(  Q,P\right)  $ as \emph{forward reflection} with respect to $\left(
P,Q\right)  $. When we apply this bijection $\phi_{P,Q}$ to an arc $a\in
A\left(  P,Q\right)  $, we say that we are \emph{forward-reflecting} it with
respect to $\left(  P,Q\right)  $. Likewise, $\phi_{P,Q}^{-1}$ will be called
\emph{backward reflection} with respect to $\left(  P,Q\right)  $. The
\textquotedblleft reflection\textquotedblright\ terminology should be taken
with a grain of salt: It does not mean that the source of the arc becomes the
target and vice versa, but only that it turns from an arc having source in $P$
and target in $Q$ into an arc having source in $Q$ and target in $P$.

We need some more definitions: If $P$ and $Q$ are two subsets of $V$
satisfying $P\sqcup Q=V$, then we define a map%
\[
\Phi_{P,Q}:\left\{  \text{subsets of }A\right\}  \rightarrow\left\{
\text{subsets of }A\right\}
\]
by%
\[
\Phi_{P,Q}\left(  B\right)  :=\left(  B\setminus A\left(  P,Q\right)  \right)
\cup\phi_{P,Q}\left(  B\cap A\left(  P,Q\right)  \right)  \qquad\text{for all
}B\subseteq A.
\]
In other words, $\Phi_{P,Q}\left(  B\right)  $ is obtained from $B$ by
forward-reflecting all arcs in $A\left(  P,Q\right)  $.

Likewise, if $P$ and $Q$ are two subsets of $V$ satisfying $P\sqcup Q=V$, then
we define a map%
\[
\Psi_{P,Q}:\left\{  \text{subsets of }A\right\}  \rightarrow\left\{
\text{subsets of }A\right\}
\]
by%
\[
\Psi_{P,Q}\left(  B\right)  :=\left(  B\setminus A\left(  Q,P\right)  \right)
\cup\phi_{P,Q}^{-1}\left(  B\cap A\left(  Q,P\right)  \right)  \qquad\text{for
all }B\subseteq A.
\]
In other words, $\Psi_{P,Q}\left(  B\right)  $ is obtained from $B$ by
backward-reflecting all arcs in $A\left(  Q,P\right)  $.

\begin{lemma}
\label{lem.realignment-acyc}Let $B$ be a subset of $V$. Let $P$ and $Q$ be two
subsets of $V$ satisfying $P\sqcup Q=V$.

Assume that $B\cap A\left(  Q,P\right)  =\varnothing$. Then:

\begin{enumerate}
\item[\textbf{(a)}] We have $\left\vert \Phi_{P,Q}\left(  B\right)
\right\vert =\left\vert B\right\vert $.

\item[\textbf{(b)}] If the set $B$ is acyclic, then so is $\Phi_{P,Q}\left(
B\right)  $.

\item[\textbf{(c)}] We have $\Psi_{P,Q}\left(  \Phi_{P,Q}\left(  B\right)
\right)  =B$.
\end{enumerate}
\end{lemma}

\begin{proof}
\textbf{(a)} The set $\phi_{P,Q}\left(  B\cap A\left(  P,Q\right)  \right)  $
is a subset of $A\left(  Q,P\right)  $ and thus disjoint from $B$ (since
$B\cap A\left(  Q,P\right)  =\varnothing$) and therefore also disjoint from
its subset $B\setminus A\left(  P,Q\right)  $. Hence,%
\begin{align*}
&  \left\vert \left(  B\setminus A\left(  P,Q\right)  \right)  \cup\phi
_{P,Q}\left(  B\cap A\left(  P,Q\right)  \right)  \right\vert \\
&  =\underbrace{\left\vert B\setminus A\left(  P,Q\right)  \right\vert
}_{=\left\vert B\right\vert -\left\vert B\cap A\left(  P,Q\right)  \right\vert
}+\underbrace{\left\vert \phi_{P,Q}\left(  B\cap A\left(  P,Q\right)  \right)
\right\vert }_{\substack{=\left\vert B\cap A\left(  P,Q\right)  \right\vert
\\\text{(since }\phi_{P,Q}\text{ is a bijection)}}}\\
&  =\left\vert B\right\vert -\left\vert B\cap A\left(  P,Q\right)  \right\vert
+\left\vert B\cap A\left(  P,Q\right)  \right\vert =\left\vert B\right\vert .
\end{align*}
Since the set on the left hand side here is $\Phi_{P,Q}\left(  B\right)  $, we
thus have shown that $\left\vert \Phi_{P,Q}\left(  B\right)  \right\vert
=\left\vert B\right\vert $. This proves Lemma \ref{lem.realignment-acyc}
\textbf{(a)}. \medskip

\textbf{(b)} Assume that the set $B$ is acyclic. We must show that $\Phi
_{P,Q}\left(  B\right)  $ is acyclic as well.

Assume the contrary. Thus, the digraph $D\left\langle \Phi_{P,Q}\left(
B\right)  \right\rangle $ has a cycle $\mathbf{c}$. If all the vertices of
$\mathbf{c}$ are contained in $P$, then $\mathbf{c}$ is also a cycle of
$D\left\langle B\right\rangle $ (since the sets $B$ and $\Phi_{P,Q}\left(
B\right)  $ differ only in the arcs that run between the sets $P$ and $Q$, not
in the arcs that stay within $P$ or within $Q$), which is absurd (since $B$ is
acyclic). Thus, not all the vertices of $\mathbf{c}$ are contained in $P$.
Similarly, not all the vertices of $\mathbf{c}$ are contained in $Q$.
Therefore, the cycle $\mathbf{c}$ contains both a vertex in $P$ and a vertex
in $Q$. Consequently, $\mathbf{c}$ must contain an arc with source in $P$ and
target in $Q$. This arc must therefore belong to $A\left(  P,Q\right)  $ and
to $\Phi_{P,Q}\left(  B\right)  $ (since $\mathbf{c}$ is a cycle of
$D\left\langle \Phi_{P,Q}\left(  B\right)  \right\rangle $). In other words,
it must belong to $\Phi_{P,Q}\left(  B\right)  \cap A\left(  P,Q\right)  $.

However, this is impossible, since the construction of $\Phi_{P,Q}\left(
B\right)  $ ensures that $\Phi_{P,Q}\left(  B\right)  \cap A\left(
P,Q\right)  =\varnothing$ (in fact, both sets $B\setminus A\left(  P,Q\right)
$ and $\phi_{P,Q}\left(  B\cap A\left(  P,Q\right)  \right)  $ are disjoint
from $A\left(  P,Q\right)  $, so their union $\Phi_{P,Q}\left(  B\right)  $ is
disjoint from $A\left(  P,Q\right)  $ as well). This contradiction completes
our proof of Lemma \ref{lem.realignment-acyc} \textbf{(b)}. \medskip

\textbf{(c)} For ease of notation, let $C := A(P,Q)$ and $D := A(Q,P)$. Also, let $\Phi := \Phi_{P,Q}$, $\Psi := \Psi_{P,Q}$, $\phi := \phi_{P,Q}$ and $\psi := \psi_{P,Q}$. We have \begin{align*}
    \Psi(\Phi(B)) &= (\Phi(B) \setminus D) \cup \phi^{-1}(\Phi(B) \cap D) \\
    &= \Big([(B \setminus C) \cup \phi(B \cap C)] \setminus D \Big) \cup \phi^{-1}\Big([(B \setminus C) \cup \phi(B \cap C)] \cap D \Big) \\
    &= [(B \setminus C) \setminus D] \cup [\phi(B \cap C) \setminus D] \cup \phi^{-1}\Big([(B \setminus C) \cap D] \cup [\phi(B \cap C) \cap D] \Big) \\
    &= [B \setminus (C \cup D) ] \cup [\phi(B) \cap \phi(C) \cap D^c] \cup [\phi^{-1}((B \setminus C) \cap D)] \cup [\phi^{-1}(\phi(B \cap C) \cap D)] \\
    &= [B \setminus (C \cup D)] \cup [\phi(B) \cap D \cap D^c] \cup [\phi^{-1}(B \cap C^c) \cap \phi^{-1}(D)] \cup [\phi^{-1}(\phi(B \cap C)) \cap \phi^{-1}(D)] \\
    &= [B \cap (C \cup D)^c] \cup \emptyset \cup [\phi^{-1}(B) \cap \phi^{-1}(C^c) \cap \phi^{-1}(D)] \cup [B \cap C \cap \phi^{-1}(D)] \\
    &= [B \cap (C \cup D)^c] \cup [\phi^{-1}(B) \cap D^c \cap C] \cup [B \cap C \cap C] \\
    &= [B \cap (C \cup D)^c] \cup [\phi^{-1}(B) \cap C] \cup [B \cap C] \\
    &= [B \cap (C \cup D)^c] \cup \phi^{-1}(B) \cup [B \cap C]
\end{align*}

\textcolor{red}{[I'm running into some issue and can't seem to find where it is...]}
\end{proof}

Now, we shall prove Theorem \ref{thm.balgamma}.

Given a subset $B$ of $A$ and two vertices $v,w\in V$, we say that
\textquotedblleft$v$ can $B$-reach $w$\textquotedblright\ if the digraph
$D\left\langle B\right\rangle $ has a path from $v$ to $w$ (or, equivalently,
a walk from $v$ to $w$).

We fix $k\in\mathbb{N}$ and two vertices $s,t\in V$. We must show that
$\gamma_{k}\left(  s\right)  =\gamma_{k}\left(  t\right)  $. This is obvious
if $s=t$, so we WLOG assume that $s\neq t$.

Let $\mathcal{P}_{k}\left(  A\right)  $ denote the set of all $k$-element
subsets of $A$. Define the subsets
\begin{align*}
\Gamma_{k}\left(  s\right)  :=  &  \ \left\{  B\in\mathcal{P}_{k}\left(
A\right)  \text{ is acyclic}\ \mid\ \text{each vertex can }B\text{-reach
}s\right\} \\
=  &  \ \left\{  B\in\mathcal{P}_{k}\left(  A\right)  \ \mid\ B\text{ is an
}s\text{-convergence}\right\}  ;\\
\Gamma_{k}\left(  t\right)  :=  &  \ \left\{  B\in\mathcal{P}_{k}\left(
A\right)  \text{ is acyclic}\ \mid\ \text{each vertex can }B\text{-reach
}t\right\} \\
=  &  \ \left\{  B\in\mathcal{P}_{k}\left(  A\right)  \ \mid\ B\text{ is a
}t\text{-convergence}\right\}  ;\\
\Gamma_{k}\left(  s,t\right)  :=  &  \ \left\{  B\in\mathcal{P}_{k}\left(
A\right)  \text{ is acyclic}\ \mid\ \text{each vertex can }B\text{-reach
}s\text{ or }t\right\}
\end{align*}
of $\mathcal{P}_{k}\left(  A\right)  $. Clearly, both $\Gamma_{k}\left(
s\right)  $ and $\Gamma_{k}\left(  t\right)  $ are subsets of $\Gamma
_{k}\left(  s,t\right)  $. Thus,
\[
\left\vert \Gamma_{k}\left(  s,t\right)  \setminus\Gamma_{k}\left(  t\right)
\right\vert =\left\vert \Gamma_{k}\left(  s,t\right)  \right\vert
-\underbrace{\left\vert \Gamma_{k}\left(  t\right)  \right\vert }_{=\gamma
_{k}\left(  t\right)  }=\left\vert \Gamma_{k}\left(  s,t\right)  \right\vert
-\gamma_{k}\left(  t\right)
\]
and likewise $\left\vert \Gamma_{k}\left(  s,t\right)  \setminus\Gamma
_{k}\left(  s\right)  \right\vert =\left\vert \Gamma_{k}\left(  s,t\right)
\right\vert -\gamma_{k}\left(  s\right)  $. Thus, in order to prove that
$\gamma_{k}\left(  s\right)  =\gamma_{k}\left(  t\right)  $, it suffices to
prove that $\left\vert \Gamma_{k}\left(  s,t\right)  \setminus\Gamma
_{k}\left(  s\right)  \right\vert =\left\vert \Gamma_{k}\left(  s,t\right)
\setminus\Gamma_{k}\left(  t\right)  \right\vert $. For this purpose, we shall
construct a bijection $\Gamma_{k}\left(  s,t\right)  \setminus\Gamma
_{k}\left(  t\right)  \rightarrow\Gamma_{k}\left(  s,t\right)  \setminus
\Gamma_{k}\left(  s\right)  $. We construct it as follows:

\begin{itemize}
\item Define a map $f:\Gamma_{k}\left(  s,t\right)  \setminus\Gamma_{k}\left(
t\right)  \rightarrow\Gamma_{k}\left(  s,t\right)  \setminus\Gamma_{k}\left(
s\right)  $ as follows: Let $B\in\Gamma_{k}\left(  s,t\right)  \setminus
\Gamma_{k}\left(  t\right)  $. Set%
\begin{align*}
P  &  =\left\{  \text{vertices that can }B\text{-reach }t\right\}  ;\\
Q  &  =V\setminus P.
\end{align*}
Then, let $f\left(  B\right)  :=\Phi_{P,Q}\left(  B\right)  $. We will soon
(Claim 1) see that this really belongs to $\Gamma_{k}\left(  s,t\right)
\setminus\Gamma_{k}\left(  s\right)  $, so that the map $f$ is well-defined.

\item Define a map $g:\Gamma_{k}\left(  s,t\right)  \setminus\Gamma_{k}\left(
s\right)  \rightarrow\Gamma_{k}\left(  s,t\right)  \setminus\Gamma_{k}\left(
t\right)  $ as follows: Let $B\in\Gamma_{k}\left(  s,t\right)  \setminus
\Gamma_{k}\left(  s\right)  $. Set%
\begin{align*}
Q^{\prime}  &  =\left\{  \text{vertices that can }B\text{-reach }s\right\}
;\\
P^{\prime}  &  =V\setminus Q^{\prime}.
\end{align*}
Then, let $g\left(  B\right)  :=\Psi_{P^{\prime},Q^{\prime}}\left(  B\right)
$. We will soon (Claim 2) see that this really belongs to $\Gamma_{k}\left(
s,t\right)  \setminus\Gamma_{k}\left(  t\right)  $, so that the map $f$ is well-defined.
\end{itemize}

We now claim the following:

\begin{statement}
\textit{Claim 1:} Let $B\in\Gamma_{k}\left(  s,t\right)  \setminus\Gamma
_{k}\left(  t\right)  $, and set%
\begin{align*}
P &  =\left\{  \text{vertices that can }B\text{-reach }t\right\}  ;\\
Q &  =V\setminus P.
\end{align*}
Then, $\Phi_{P,Q}\left(  B\right)  \in\Gamma_{k}\left(  s,t\right)
\setminus\Gamma_{k}\left(  s\right)  $.
\end{statement}

\begin{statement}
\textit{Claim 2:} Let $B\in\Gamma_{k}\left(  s,t\right)  \setminus\Gamma
_{k}\left(  s\right)  $, and set%
\begin{align*}
Q^{\prime}  &  =\left\{  \text{vertices that can }B\text{-reach }s\right\}
;\\
P^{\prime}  &  =V\setminus Q^{\prime}.
\end{align*}
Then, $\Psi_{P^{\prime},Q^{\prime}}\left(  B\right)  \in\Gamma_{k}\left(
s,t\right)  \setminus\Gamma_{k}\left(  s\right)  $.
\end{statement}

\begin{statement}
\textit{Claim 3:} We have $g\circ f=\operatorname*{id}$.
\end{statement}

\begin{statement}
\textit{Claim 4:} We have $f\circ g=\operatorname*{id}$.
\end{statement}

\begin{proof}
[Proof of Claim 1.]First of all, if there was some arc $a\in B\cap A\left(
Q,P\right)  $, say with source $v$ and target $w$, then the vertex $w$ could
$B$-reach $t$ but $v$ could not; but this is absurd, since $v$ could $B$-reach
$t$ via this arc $a$ and the vertex $w$. Hence, there exists no such arc $a$.
In other words, $B\cap A\left(  Q,P\right)  =\varnothing$. Hence, Lemma
\ref{lem.realignment-acyc} \textbf{(a)} yields $\left\vert \Phi_{P,Q}\left(
B\right)  \right\vert =\left\vert B\right\vert =k$ (since $B\in\Gamma
_{k}\left(  s,t\right)  \setminus\Gamma_{k}\left(  t\right)  \subseteq
\Gamma_{k}\left(  s,t\right)  \subseteq\mathcal{P}_{k}\left(  A\right)  $). In
other words, $\Phi_{P,Q}\left(  B\right)  \in\mathcal{P}_{k}\left(  A\right)
$. Moreover, Lemma \ref{lem.realignment-acyc} \textbf{(b)} yields that
$\Phi_{P,Q}\left(  B\right)  $ is acyclic (since $B\in\Gamma_{k}\left(
s,t\right)  $ shows that $B$ is acyclic).

Next, we shall show that $\Phi_{P,Q}\left(  B\right)  \in\Gamma_{k}\left(
s,t\right)  $. Since we know that $\Phi_{P,Q}\left(  B\right)  $ is acyclic,
we only need to show that each vertex $v\in V$ can $\Phi_{P,Q}\left(
B\right)  $-reach $s$ or $t$. So let $v\in V$ be any vertex. Since $B\in
\Gamma_{k}\left(  s,t\right)  $, we know that $v$ can $B$-reach $s$ or $t$.
That is, the digraph $D\left\langle B\right\rangle $ has a path $\mathbf{p}$
from $v$ to $s$ or $t$. If this path no longer exists in $D\left\langle
\Phi_{P,Q}\left(  B\right)  \right\rangle $, then it must contain one of the
arcs in $B\cap A\left(  P,Q\right)  $ that get forward-reflected in
$\Phi_{P,Q}\left(  B\right)  $. In this case, TODO!

\begin{itemize}
\item Let $v\in V$. We must show that $v$ can $\Phi_{P,Q}\left(  B\right)
$-reach $s$ or $t$.

\item If $v$ can $B$-reach $t$, then the path stays within $P$ and thus
remains a path in $\Phi_{P,Q}\left(  B\right)  $, so we're done.

\item If not, then the path stays entirely within $Q$ (otherwise, we could
reach $t$ from $v$) and thus remains a path in $\Phi_{P,Q}\left(  B\right)  $,
so we're done.
\end{itemize}

Finally, we shall show that $\Phi_{P,Q}\left(  B\right)  \notin\Gamma
_{k}\left(  s\right)  $. Indeed, the vertex $t$ cannot $\Phi_{P,Q}\left(
B\right)  $-reach $s$, since TODO!

\begin{itemize}
\item The vertex $s$ cannot $B$-reach $t$, since $B\notin\Gamma_{k}\left(
t\right)  $. So $s\in Q$. But $t\in P$ obviously. A $P$-vertex cannot
$\Phi_{P,Q}\left(  B\right)  $-reach a $Q$-vertex, since  $\Phi_{P,Q}\left(
B\right)  \cap A\left(  P,Q\right)  =\varnothing$. Hence $t$ cannot
$\Phi_{P,Q}\left(  B\right)  $-reach $s$. Therefore, $\Phi_{P,Q}\left(
B\right)  \notin\Gamma_{k}\left(  s\right)  $.
\end{itemize}

Combining these, we obtain $\Phi_{P,Q}\left(  B\right)  \in\Gamma_{k}\left(
s,t\right)  \setminus\Gamma_{k}\left(  s\right)  $. This proves Claim 1.
\end{proof}

\begin{proof}
[Proof of Claim 2.]Claim 2 is the same as Claim 1, but with $s$, $t$, $P$,
$Q$, $\phi_{P,Q}$ and $\Phi_{P,Q}$ renamed as $t$, $s$, $Q^{\prime}$,
$P^{\prime}$, $\phi_{P^{\prime},Q^{\prime}}^{-1}$ and $\Psi_{P^{\prime
},Q^{\prime}}$. (In fact, since $\phi_{P^{\prime},Q^{\prime}}$ is a bijection
from $A\left(  P^{\prime},Q^{\prime}\right)  $ to $A\left(  Q^{\prime
},P^{\prime}\right)  $, we know that $\phi_{P^{\prime},Q^{\prime}}^{-1}$ is a
bijection from $A\left(  Q^{\prime},P^{\prime}\right)  $ to $A\left(
P^{\prime},Q^{\prime}\right)  $, so that the situations really are comparable.)
\end{proof}

\begin{proof}
[Proof of Claim 3.]Let $B\in\Gamma_{k}\left(  s,t\right)  \setminus\Gamma
_{k}\left(  t\right)  $. We must show that $\left(  g\circ f\right)  \left(
B\right)  =B$.

Note that $B\cap A\left(  Q,P\right)  =\varnothing$ (as we saw in the proof of
Claim 1).

Set $B^{\prime}:=f\left(  B\right)  $. Define
\begin{align*}
P &  =\left\{  \text{vertices that can }B\text{-reach }t\right\}  ;\\
Q &  =V\setminus P.
\end{align*}
Then, $B^{\prime}=f\left(  B\right)  =\Phi_{P,Q}\left(  B\right)  $ by the
definition of $f$.

Define
\begin{align*}
Q^{\prime} &  =\left\{  \text{vertices that can }B^{\prime}\text{-reach
}s\right\}  ;\\
P^{\prime} &  =V\setminus Q^{\prime}.
\end{align*}
Then, $g\left(  B^{\prime}\right)  =\Psi_{P^{\prime},Q^{\prime}}\left(
B^{\prime}\right)  $ by the definition of $g$. But
\[
\left(  g\circ f\right)  \left(  B\right)  =g\left(  \underbrace{f\left(
B\right)  }_{=B^{\prime}}\right)  =g\left(  B^{\prime}\right)  =\Psi
_{P^{\prime},Q^{\prime}}\left(  B^{\prime}\right)  .
\]


We shall show that $P^{\prime}=P$ and $Q^{\prime}=Q$. Once shown, this will
entail
\begin{align*}
\Psi_{P^{\prime},Q^{\prime}}\left(  B^{\prime}\right)    & =\Psi_{P,Q}\left(
\underbrace{B^{\prime}}_{=\Phi_{P,Q}\left(  B\right)  }\right)  =\Psi
_{P,Q}\left(  \Phi_{P,Q}\left(  B\right)  \right)  \\
& =B\ \ \ \ \ \ \ \ \ \ \left(  \text{by Lemma \ref{lem.realignment-acyc}
\textbf{(c)}}\right)  ,
\end{align*}
so that $\left(  g\circ f\right)  \left(  B\right)  =\Psi_{P^{\prime
},Q^{\prime}}\left(  B^{\prime}\right)  =B$. This will complete the proof of
Claim 3.

TODO. 
\end{proof}

\begin{proof}
[Proof of Claim 4.]TODO.
\end{proof}

Claim 3 and Claim 4 show that the maps $\Phi_{P,Q}$ and $\Psi_{P^{\prime
},Q^{\prime}}$ are mutually inverse. Hence, $\Phi_{P,Q}$ is a bijection. Thus,
the bijection principle yields%
\[
\left\vert \Gamma_{k}\left(  s,t\right)  \setminus\Gamma_{k}\left(  t\right)
\right\vert =\left\vert \Gamma_{k}\left(  s,t\right)  \setminus\Gamma
_{k}\left(  s\right)  \right\vert .
\]
As we explained above, this leads to $\gamma_{k}\left(  s\right)  =\gamma
_{k}\left(  t\right)  $, and thus Theorem \ref{thm.balgamma} is proved.

\section{Further remarks on $s$-convergences}

\begin{itemize}
\item It is easy to see that an $s$-convergence contains no arcs with source
$s$.

\item An equivalent way to define $s$-convergences is this: An $s$-convergence
is an acyclic subset $B$ of $A$ such that $s$ is the only sink (= vertex with
no outgoing arcs) of the subdigraph $D\left\langle B\right\rangle $.
\end{itemize}

\begin{noncompile}
In proving Conjecture \ref{conj.karla}, we can WLOG assume that $D$ is weakly
connected (otherwise, $\gamma_{k}\left(  s\right)  =0$ for all $k$ and $s$).
In this case, $D$ has a Eulerian circuit (\cite[Theorem 4.7.2]{22s}), hence is
strongly connected. Thus, in proving $\gamma_{k}\left(  s\right)  =\gamma
_{k}\left(  t\right)  $, we can WLOG assume that $D$ has an arc from $s$ to
$t$. Not sure if this makes things any simpler. At least it might make it
simpler to check random $D$'s, since we can sample $D$ by randomly drawing an
Eulerian circuit.

Another simplification we can make: If $v$ is a vertex with $\deg^{-}%
v=\deg^{+}v=1$, then we can replace the arcs $p\rightarrow v$ and
$v\rightarrow q$ by a single arc $p\rightarrow q$. Thus, WLOG we can assume
that each vertex $v$ of $D$ has $\deg^{-}v=\deg^{+}v\geq2$.
\end{noncompile}

\begin{thebibliography}{99999999}                                                                                         %


\bibitem[22s]{22s}\href{https://arxiv.org/abs/2308.04512v3}{Darij Grinberg,
\textit{An introduction to graph theory}, arXiv:2308.04512v3.}

\bibitem[Foissy22]{Foissy22}%
\href{https://arxiv.org/abs/2201.11974v5}{Lo\"{\i}c Foissy, \textit{Bialgebras
in cointeraction, the antipode and the eulerian idempotent},
arXiv:2201.11974v5.}

\bibitem[LeiVal24]{LeiVal24}\href{https://arxiv.org/abs/2402.09914v3}{Karla
Leipold, Frank Vallentin, \textit{Computing the EHZ capacity is NP-hard},
arXiv:2402.09914v3.}

\bibitem[PerPha15]{PerPha15}K\'{e}vin Perrot, Trung Van Pham, \textit{Feedback
Arc Set Problem and NP-Hardness of Minimum Recurrent Configuration Problem of
Chip-Firing Game on Directed Graphs}, Annals of Combinatorics \textbf{19}
(2015), pages 373--396.
\end{thebibliography}


\end{document}
