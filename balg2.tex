\documentclass[numbers=enddot,12pt,final,onecolumn,notitlepage]{scrartcl}%
\usepackage[headsepline,footsepline,manualmark]{scrlayer-scrpage}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{framed}
\usepackage{comment}
\usepackage{color}
\usepackage[breaklinks=True]{hyperref}
\usepackage[sc]{mathpazo}
\usepackage[T1]{fontenc}
\usepackage{needspace}
\usepackage{tabls}
\usepackage{tikz}
%TCIDATA{OutputFilter=latex2.dll}
%TCIDATA{Version=5.50.0.2960}
%TCIDATA{LastRevised=Friday, July 18, 2025 20:00:36}
%TCIDATA{SuppressPackageManagement}
%TCIDATA{<META NAME="GraphicsSave" CONTENT="32">}
%TCIDATA{<META NAME="SaveForMode" CONTENT="1">}
%TCIDATA{BibliographyScheme=Manual}
%TCIDATA{Language=American English}
%BeginMSIPreambleData
\providecommand{\U}[1]{\protect\rule{.1in}{.1in}}
%EndMSIPreambleData
\theoremstyle{definition}
\newtheorem{theo}{Theorem}[section]
\newenvironment{theorem}[1][]
{\begin{theo}[#1]\begin{leftbar}}
{\end{leftbar}\end{theo}}
\newtheorem{lem}[theo]{Lemma}
\newenvironment{lemma}[1][]
{\begin{lem}[#1]\begin{leftbar}}
{\end{leftbar}\end{lem}}
\newtheorem{prop}[theo]{Proposition}
\newenvironment{proposition}[1][]
{\begin{prop}[#1]\begin{leftbar}}
{\end{leftbar}\end{prop}}
\newtheorem{defi}[theo]{Definition}
\newenvironment{definition}[1][]
{\begin{defi}[#1]\begin{leftbar}}
{\end{leftbar}\end{defi}}
\newtheorem{remk}[theo]{Remark}
\newenvironment{remark}[1][]
{\begin{remk}[#1]\begin{leftbar}}
{\end{leftbar}\end{remk}}
\newtheorem{coro}[theo]{Corollary}
\newenvironment{corollary}[1][]
{\begin{coro}[#1]\begin{leftbar}}
{\end{leftbar}\end{coro}}
\newtheorem{conv}[theo]{Convention}
\newenvironment{convention}[1][]
{\begin{conv}[#1]\begin{leftbar}}
{\end{leftbar}\end{conv}}
\newtheorem{quest}[theo]{Question}
\newenvironment{question}[1][]
{\begin{quest}[#1]\begin{leftbar}}
{\end{leftbar}\end{quest}}
\newtheorem{warn}[theo]{Warning}
\newenvironment{warning}[1][]
{\begin{warn}[#1]\begin{leftbar}}
{\end{leftbar}\end{warn}}
\newtheorem{conj}[theo]{Conjecture}
\newenvironment{conjecture}[1][]
{\begin{conj}[#1]\begin{leftbar}}
{\end{leftbar}\end{conj}}
\newtheorem{exam}[theo]{Example}
\newenvironment{example}[1][]
{\begin{exam}[#1]\begin{leftbar}}
{\end{leftbar}\end{exam}}
\newenvironment{statement}{\begin{quote}}{\end{quote}}
\newenvironment{fineprint}{\begin{small}}{\end{small}}
\iffalse
\newenvironment{proof}[1][Proof]{\noindent\textbf{#1.} }{\ \rule{0.5em}{0.5em}}
\newenvironment{convention}[1][Convention]{\noindent\textbf{#1.} }{\ \rule{0.5em}{0.5em}}
\newenvironment{question}[1][Question]{\noindent\textbf{#1.} }{\ \rule{0.5em}{0.5em}}
\newenvironment{warning}[1][Warning]{\noindent\textbf{#1.} }{\ \rule{0.5em}{0.5em}}
\fi
\let\sumnonlimits\sum
\let\prodnonlimits\prod
\let\cupnonlimits\bigcup
\let\capnonlimits\bigcap
\renewcommand{\sum}{\sumnonlimits\limits}
\renewcommand{\prod}{\prodnonlimits\limits}
\renewcommand{\bigcup}{\cupnonlimits\limits}
\renewcommand{\bigcap}{\capnonlimits\limits}
\setlength\tablinesep{3pt}
\setlength\arraylinesep{3pt}
\setlength\extrarulesep{3pt}
\setlength\textheight{22.5cm}
\setlength\textwidth{14.8cm}
\newenvironment{verlong}{}{}
\newenvironment{vershort}{}{}
\newenvironment{noncompile}{}{}
\excludecomment{verlong}
\includecomment{vershort}
\excludecomment{noncompile}
\newcommand{\defn}[1]{{\color{darkred}\emph{#1}}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\KK}{\mathbb{K}}
\newcommand{\set}[1]{\left\{ #1 \right\}}
\newcommand{\abs}[1]{\left| #1 \right|}
\newcommand{\tup}[1]{\left( #1 \right)}
\newcommand{\ive}[1]{\left[ #1 \right]}
\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\mono}{\hookrightarrow}
\newcommand{\epi}{\twoheadrightarrow}
\newcommand{\iso}{\overset{\cong}{\to}}
\newcommand{\symd}{\mathbin{\bigtriangleup}}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{calc}
\usetikzlibrary{chains}
\usetikzlibrary{shapes}
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{lindenmayersystems}
\definecolor{darkgreen}{rgb}{0,.5,0}
\newtheoremstyle{plainsl}
{8pt plus 2pt minus 4pt}
{8pt plus 2pt minus 4pt}
{\slshape}
{0pt}
{\bfseries}
{.}
{5pt plus 1pt minus 1pt}
{}
\theoremstyle{plainsl}
\ihead{An equality for balanced digraphs, version \today}
\ohead{page \thepage}
\cfoot{}
\begin{document}

\title{An equality for balanced digraphs}
\author{Darij Grinberg\thanks{Drexel University, Philadelphia, PA.
\href{mailto:darijgrinberg@gmail.com}{\texttt{darijgrinberg@gmail.com}}},
Benjamin Liber\thanks{Drexel University, Philadelphia, PA.
\href{mailto:bl839@drexel.edu}{\texttt{bl839@drexel.edu}}}}
\date{ROUGH DRAFT, \today}
\maketitle

\begin{abstract}
Consider a directed multigraph $D$ that is balanced (i.e., at each vertex, the
indegree equals the outdegree). Let $A$ be its set of arcs. Fix an integer
$k\in\mathbb{N}$. Let $s$ be a vertex of $D$. We show that the number of
$k$-element subsets $B$ of $A$ that contain no cycles but contain a path from
each vertex to $s$ (we call them \textquotedblleft$s$%
-convergences\textquotedblright) is independent on $s$. This generalizes known
facts about spanning arborescences, about acyclic orientations and maximal
acyclic subdigraphs.

\end{abstract}

\section{The theorem}

In this note, we shall discussed \emph{balanced multidigraphs} -- i.e.,
directed multigraphs (allowing loops and multiple arcs) in which each vertex
satisfies \textquotedblleft outdegree = indegree\textquotedblright. We recall
the relevant definitions in more detail:

A \emph{multidigraph} (henceforth just \emph{digraph}) means a triple
$(V,A,\psi)$, where $V$ and $A$ are two finite sets and $\psi: A \to V \times
V$ is a map. The elements of $V$ are called the \emph{vertices} of this
digraph, and the elements of $A$ are called the \emph{arcs} of this digraph.
The \emph{source} and \emph{target} of an arc $a \in A$ are, respectively, the
first and second entries of the pair $\psi(a)$. The \emph{indegree} $\deg
^{-}v$ of a vertex $v \in V$ means the number of arcs $a \in A$ whose target
is $v$. The \emph{outdegree} $\deg^{+}v$ of a vertex $v \in V$ means the
number of arcs $a \in A$ whose source is $v$. We say that a digraph
$(V,A,\psi)$ is \emph{balanced} if and only if each vertex $v \in V$ satisfies
$\deg^{+}v = \deg^{-}v$. For further terminology on digraphs, we refer to
\cite{22s}.\footnote{The famous directed Euler--Hierholzer theorem (which will
not be used in this note) says that a weakly connected digraph contains an
Eulerian circuit if and only if it is balanced. Thus, weakly connected
balanced digraphs are also known as \emph{Eulerian digraphs}.}

A \emph{to-root} of a digraph $D$ means a vertex $s$ of $D$ such that for each
vertex $v$ of $D$, the digraph $D$ has a path from $v$ to $s$ (equivalently, a
walk from $v$ to $s$).

From now on, we \textbf{fix a balanced digraph} $D = (V,A,\psi)$. If $B$ is
any subset of $A$, then $D \left\langle B \right\rangle $ will denote the
induced subdigraph $\left(  V,B,\psi\mid_{B}\right)  $. A subset $B$ of $A$
will be called \emph{acyclic} if the subdigraph $D \left\langle B
\right\rangle $ has no (directed) cycles.

Given a vertex $s$ of $D$, we define an \emph{$s$-convergence} to be an
acyclic subset $B$ of $A$ such that $s$ is a to-root of the subdigraph $D
\left\langle B \right\rangle $.

We can think of an $s$-convergence as a set $B$ of arcs of $D$ such that by
following the $B$-arcs (i.e. the arcs in $B$) from any vertex $v \in V$, we
will always arrive at $s$ (no matter which $B$-arcs we take), and we will be
stuck at $s$.

For any $k\in\mathbb{N}$ and $s\in V$, we let $\gamma_{k}\left(  s\right)  $
denote the number of $s$-convergences of size $k$ (that is, with $k$ arcs).

In this note, we shall prove the following result:

\begin{theorem}
\label{thm.balgamma}Let $k\in\mathbb{N}$. The number $\gamma_{k}\left(
s\right)  $ does not depend on $s$. That is, $\gamma_{k}\left(  s\right)
=\gamma_{k}\left(  t\right)  $ for any $s,t\in V$.
\end{theorem}

\begin{example}
Let $D$ be the following balanced multidigraph:%
\[%
%TCIMACRO{\TeXButton{tikz multidigraph}{\begin{tikzpicture}[scale=4]
%\begin{scope}[every node/.style={circle,thick,draw=green!60!black}]
%\node(1) at (0,0) {$1$};
%\node(2) at (0,1) {$2$};
%\node(3) at (1,1) {$3$};
%\node(4) at (1,0) {$4$};
%\end{scope}
%\begin{scope}[every edge/.style={draw=black,very thick}, every loop/.style={}]
%\path[->] (1) edge[bend left=20] node[left] {$a$} (2);
%\path[->] (2) edge[bend left=20] node[right] {$b$} (1);
%\path[->] (2) edge node[above] {$c$} (3);
%\path[->] (3) edge node[right] {$d$} (4);
%\path[->] (4) edge node[above] {$e$} (2);
%\path[->] (1) edge[bend left=20] node[above] {$f$} (4);
%\path[->] (4) edge[bend left=20] node[below] {$g$} (1);
%\end{scope}
%\end{tikzpicture}}}%
%BeginExpansion
\begin{tikzpicture}[scale=4]
\begin{scope}[every node/.style={circle,thick,draw=green!60!black}]
\node(1) at (0,0) {$1$};
\node(2) at (0,1) {$2$};
\node(3) at (1,1) {$3$};
\node(4) at (1,0) {$4$};
\end{scope}
\begin{scope}[every edge/.style={draw=black,very thick}, every loop/.style={}]
\path[->] (1) edge[bend left=20] node[left] {$a$} (2);
\path[->] (2) edge[bend left=20] node[right] {$b$} (1);
\path[->] (2) edge node[above] {$c$} (3);
\path[->] (3) edge node[right] {$d$} (4);
\path[->] (4) edge node[above] {$e$} (2);
\path[->] (1) edge[bend left=20] node[above] {$f$} (4);
\path[->] (4) edge[bend left=20] node[below] {$g$} (1);
\end{scope}
\end{tikzpicture}%
%EndExpansion
\]
Then, the $1$-convergences are the subsets%
\[
\left\{  b,d,g\right\}  ,\ \ \ \ \ \ \ \ \ \ \left\{  b,d,e\right\}
,\ \ \ \ \ \ \ \ \ \ \left\{  c,d,g\right\}  ,\ \ \ \ \ \ \ \ \ \ \left\{
b,d,e,g\right\}  ,\ \ \ \ \ \ \ \ \ \ \left\{  b,c,d,g\right\}  .
\]
Hence, $\gamma_{3}\left(  1\right)  =3$, $\gamma_{4}\left(  1\right)  =2$, and
$\gamma_{k}\left(  1\right)  =0$ for all $k\notin\left\{  3,4\right\}  $. As a
visual, below is the spanning subdigraph $D\left\langle B\right\rangle $ for
$B=\left\{  b,d,e,g\right\}  $:
\[%
%TCIMACRO{\TeXButton{tikz multidigraph}{\begin{tikzpicture}[scale=4]
%\begin{scope}[every node/.style={circle,thick,draw=green!60!black}]
%\node(1) at (0,0) {$1$};
%\node(2) at (0,1) {$2$};
%\node(3) at (1,1) {$3$};
%\node(4) at (1,0) {$4$};
%\end{scope}
%\begin{scope}[every edge/.style={draw=black,very thick}, every loop/.style={}]
%\path[->] (2) edge[bend left=20] node[right] {$b$} (1);
%\path[->] (3) edge node[right] {$d$} (4);
%\path[->] (4) edge node[above] {$e$} (2);
%\path[->] (4) edge[bend left=20] node[below] {$g$} (1);
%\end{scope}
%\end{tikzpicture}}}%
%BeginExpansion
\begin{tikzpicture}[scale=4]
\begin{scope}[every node/.style={circle,thick,draw=green!60!black}]
\node(1) at (0,0) {$1$};
\node(2) at (0,1) {$2$};
\node(3) at (1,1) {$3$};
\node(4) at (1,0) {$4$};
\end{scope}
\begin{scope}[every edge/.style={draw=black,very thick}, every loop/.style={}]
\path[->] (2) edge[bend left=20] node[right] {$b$} (1);
\path[->] (3) edge node[right] {$d$} (4);
\path[->] (4) edge node[above] {$e$} (2);
\path[->] (4) edge[bend left=20] node[below] {$g$} (1);
\end{scope}
\end{tikzpicture}%
%EndExpansion
\]


\noindent Theorem \ref{thm.balgamma} says that for all $v \in\{1,2,3,4\}$,
$\gamma_{3}(v) = 3$, $\gamma_{4}(v) = 2$, and $\gamma_{k}(v) = 0$ for all $k
\notin\{3,4\}$. For example, the $2$-convergences are the subsets
\[
\left\{  a,d,e\right\}  ,\ \ \ \ \ \ \ \ \ \ \left\{  a,d,g\right\}
,\ \ \ \ \ \ \ \ \ \ \left\{  d,e,f\right\}  ,\ \ \ \ \ \ \ \ \ \ \left\{
a,d,e,f\right\}  ,\ \ \ \ \ \ \ \ \ \ \left\{  a,d,e,g\right\}  .
\]
Hence, $\gamma_{3}(2) = 3 = \gamma_{3}(1)$, $\gamma_{4}(2) = 2 = \gamma
_{4}(1)$, and $\gamma_{k}(2) = 0 = \gamma_{k}(1)$ for all $k \in\{3,4\}$. The
same holds for $v = 3,4$.
\end{example}

\section{Particular cases}

Theorem \ref{thm.balgamma} was inspired by a talk of Karla Leipold (NORCOM
2025), which made the first author aware of \cite[Lemma 4.1]{LeiVal24}. While
no enumerative questions were discussed in said talk, a scent of bijection was
noticeable. The present note is the result of following this scent.

Some particular cases of Theorem \ref{thm.balgamma} are known:

\begin{enumerate}
\item When $k=\left\vert V\right\vert -1$, the $s$-convergences $B$ of size
$k$ (or, more precisely, the respective subdigraphs $D\left\langle
B\right\rangle $ of $D$) are precisely the spanning arborescences of $D$
rooted to $s$ (see \cite[Definition 5.10.1 \textbf{(b)}]{22s} for the
definition of this). Indeed, the condition $\left\vert B\right\vert
=\left\vert V\right\vert -1$, combined with the to-rootness of $s$, forces
$D\left\langle B\right\rangle $ to be an arborescence rooted to $s$ (by
\cite[Theorem 5.10.5]{22s}), and conversely, if $D\left\langle B\right\rangle
$ is a spanning arborescence rooted to $s$, then \cite[Theorem 5.10.5]{22s}
shows that $B$ is acyclic and $\left\vert B\right\vert =\left\vert
V\right\vert -1$. Thus, in the case $k=\left\vert V\right\vert -1$, Theorem
\ref{thm.balgamma} is just \cite[Corollary 5.12.1]{22s}.

Likewise, if $k<\left\vert V\right\vert -1$, then Theorem \ref{thm.balgamma}
is just saying that $0=0$, since a spanning subdigraph $D\left\langle
B\right\rangle $ with fewer than $\left\vert V\right\vert -1$ arcs cannot have
a to-root.

\item If $D=G^{\operatorname*{bidir}}$ for some undirected multigraph
$G=\left(  V,E,\varphi\right)  $ (this means that $D$ is obtained from $G$ by
\textquotedblleft splitting\textquotedblright\ each edge $e$ into two arcs
$e^{\rightarrow}$ and $e^{\leftarrow}$, going in opposite directions), and if
$k=\left\vert E\right\vert =\left\vert A\right\vert /2$, then the
$s$-convergences $B$ are just the acyclic orientations of $G$ with unique sink
$s$ (because the acyclicity condition forbids $B$ from containing both
$e^{\rightarrow}$ and $e^{\leftarrow}$ for any given edge $e\in E$, but the
size condition $\left\vert B\right\vert =k=\left\vert E\right\vert $ forces
$B$ to contain at least one of these two arcs). Thus, in this case, Theorem
\ref{thm.balgamma} is saying that the number of acyclic orientations of a
given multigraph $G$ with unique sink $s$ does not depend on $s$. This is part
of a result by Greene and Zaslavsky \cite[Theorem 7.3]{GreZas83}, proved using
hyperplane arrangements, and has recently been reproved combinatorially by
Foissy \cite[Proposition 4.6]{Foissy22}.

\item Up to reversing the directions of the arcs, \cite[Proposition
3.7]{PerPha15} is Theorem \ref{thm.balgamma} for a specific value of $k$ --
namely, for the maximum possible that makes $\gamma_{k}\left(  s\right)  $ nonzero.

We note that when $D$ is weakly connected, then this maximum $k$ is also the
maximum size of an acyclic subset of $A$ (not just of an $s$-convergence).
This is a consequence of \cite[Theorem 3.4]{PerPha15}, and connects the
problem to the \emph{maximum acyclic subdigraph problem}, which is known to be NP-complete.

TODO: see if something from
https://en.wikipedia.org/wiki/Feedback\_arc\_set\#Equivalences is relevant to us.
\end{enumerate}

\section{The proof}

We will prove Theorem~\ref{thm.balgamma} through a sequence of lemmas, which
are self-contained and might be of independent interest.

For two sets $P$ and $Q$, we shall use the notation $P\sqcup Q$ to denote the
\emph{disjoint union} of $P$ and $Q$, that is, the union $P\cup Q$ if the
intersection $P\cap Q$ is empty. Otherwise, $P\sqcup Q$ does not exist. Of
course, if $P\sqcup Q$ exists, then $\left\vert P\sqcup Q\right\vert
=\left\vert P\right\vert +\left\vert Q\right\vert $.

For any subsets $P$ and $Q$ of $V$, let $A(P,Q)$ denote the set of arcs in $A$
whose source belongs to $P$ and whose target belongs to $Q$. The following
fact is simple but crucial:

\begin{proposition}
\label{prop.A-symmetry}Let $P$ and $Q$ be two subsets of $V$ such that
$P\sqcup Q=V$. Then,
\[
\left\vert A\left(  P,Q\right)  \right\vert =\left\vert A\left(  Q,P\right)
\right\vert .
\]

\end{proposition}

\begin{proof}
This is a known fact (see, e.g., \cite[Exercise 9.1]{22s}). The easiest way to
prove it is by observing that%
\[
A\left(  P,V\right)  =A\left(  P,P\right)  \sqcup A\left(  P,Q\right)
\]
(since the target of an arc belongs to either $P$ or $Q$ but not to both), so
that%
\[
\left\vert A\left(  P,V\right)  \right\vert =\left\vert A\left(  P,P\right)
\right\vert +\left\vert A\left(  P,Q\right)  \right\vert .
\]
However, we can count the arcs in $A\left(  P,V\right)  $ according to their
sources $p\in P$. This yields%
\begin{equation}
\left\vert A\left(  P,V\right)  \right\vert =\sum_{p\in P}\deg^{+}p,
\label{pf.prop.A-symmetry.3}%
\end{equation}
since each arc in $A\left(  P,V\right)  $ is counted in the outdegree of
exactly one $p\in P$ (namely, of its source). Comparing these two equalities,
we obtain%
\begin{equation}
\sum_{p\in P}\deg^{+}p=\left\vert A\left(  P,P\right)  \right\vert +\left\vert
A\left(  P,Q\right)  \right\vert . \label{pf.prop.A-symmetry.4}%
\end{equation}


\noindent On the other hand, $A\left(  V,P\right)  =A\left(  Q,P\right)
\sqcup A\left(  P,P\right)  $ and thus%
\[
\left\vert A\left(  V,P\right)  \right\vert =\left\vert A\left(  Q,P\right)
\right\vert +\left\vert A\left(  P,P\right)  \right\vert .
\]
Similarly to (\ref{pf.prop.A-symmetry.3}), we can show that%
\[
\left\vert A\left(  V,P\right)  \right\vert =\sum_{p\in P}\deg^{-}p.
\]
Comparing these two equalities, we obtain%
\begin{equation}
\sum_{p\in P}\deg^{-}p=\left\vert A\left(  Q,P\right)  \right\vert +\left\vert
A\left(  P,P\right)  \right\vert . \label{pf.prop.A-symmetry.5}%
\end{equation}


The left hand sides of the equalities (\ref{pf.prop.A-symmetry.4}) and
(\ref{pf.prop.A-symmetry.5}) are equal (since $D$ is balanced, so that each
$p\in P$ satisfies $\deg^{+}p=\deg^{-}p$). Hence, their right hand sides must
be equal as well. That is,%
\[
\left\vert A\left(  P,P\right)  \right\vert +\left\vert A\left(  P,Q\right)
\right\vert =\left\vert A\left(  Q,P\right)  \right\vert +\left\vert A\left(
P,P\right)  \right\vert .
\]
Subtracting $\left\vert A\left(  P,P\right)  \right\vert $ from this equality,
we obtain $\left\vert A\left(  P,Q\right)  \right\vert =\left\vert A\left(
Q,P\right)  \right\vert $. Thus, Proposition \ref{prop.A-symmetry} is proved.
\end{proof}

Now, given a subset $B$ of $A$ and two vertices $v,w\in V$, we say that
\textquotedblleft$v$ \emph{can $B$-reach} $w$\textquotedblright\ if the
digraph $D\left\langle B\right\rangle $ has a path from $v$ to $w$ (or,
equivalently, a walk from $v$ to $w$).

Fix two vertices $s,t\in V$. We want to show that $\gamma_{k}\left(  s\right)
=\gamma_{k}\left(  t\right)  $ for all $k\in\mathbb{N}$. This is clear if
$s=t$, so we may assume without loss of generality that $s\neq t$.

For any subset $B$ of $A$, we define the subsets%
\begin{align*}
S\left(  B\right)   &  :=\left\{  v\in V\ \mid\ v\text{ can }B\text{-reach
}s\right\}  \ \ \ \ \ \ \ \ \ \ \text{and}\\
T\left(  B\right)   &  :=\left\{  v\in V\ \mid\ v\text{ can }B\text{-reach
}t\right\}  .
\end{align*}
We call them the \emph{basins} of $s$ and $t$ with respect to $B$. Note that
$s\in S\left(  B\right)  $ and $t\in T\left(  B\right)  $ always hold.

Let $\mathcal{P}_{k}\left(  A\right)  $ denote the set of all $k$-element
subsets of a set $A$ (for $k\in\mathbb{Z}$). For each $k\in\mathbb{N}$, define
the subsets
\begin{align*}
\Gamma_{k}\left(  s\right)  :=  &  \ \left\{  B\in\mathcal{P}_{k}\left(
A\right)  \text{ is acyclic}\ \mid\ \text{each vertex can }B\text{-reach
}s\right\} \\
=  &  \ \left\{  B\in\mathcal{P}_{k}\left(  A\right)  \ \mid\ B\text{ is an
}s\text{-convergence}\right\} \\
=  &  \ \left\{  B\in\mathcal{P}_{k}\left(  A\right)  \text{ is acyclic}%
\ \mid\ V=S\left(  B\right)  \right\}  ;\\
\Gamma_{k}\left(  t\right)  :=  &  \ \left\{  B\in\mathcal{P}_{k}\left(
A\right)  \text{ is acyclic}\ \mid\ \text{each vertex can }B\text{-reach
}t\right\} \\
=  &  \ \left\{  B\in\mathcal{P}_{k}\left(  A\right)  \ \mid\ B\text{ is a
}t\text{-convergence}\right\}  ;\\
=  &  \ \left\{  B\in\mathcal{P}_{k}\left(  A\right)  \text{ is acyclic}%
\ \mid\ V=T\left(  B\right)  \right\}  ;\\
U_{k}:=  &  \ \left\{  B\in\mathcal{P}_{k}\left(  A\right)  \text{ is
acyclic}\ \mid\ \text{each vertex can }B\text{-reach }s\text{ or }t\right\}
;\\
=  &  \ \left\{  B\in\mathcal{P}_{k}\left(  A\right)  \text{ is acyclic}%
\ \mid\ V=S\left(  B\right)  \cup T\left(  B\right)  \right\}
\end{align*}
of $\mathcal{P}_{k}\left(  A\right)  $. (The letter $U$ signifies
\textquotedblleft Union\textquotedblright.)

Clearly, both $\Gamma_{k}\left(  s\right)  $ and $\Gamma_{k}\left(  t\right)
$ are subsets of $U_{k}$. Moreover, $\left\vert \Gamma_{k}\left(  s\right)
\right\vert =\gamma_{k}\left(  s\right)  $ and $\left\vert \Gamma_{k}\left(
t\right)  \right\vert =\gamma_{k}\left(  t\right)  $.

Now we claim the following:

\begin{lemma}
\label{lem.new1} We have%
\[
\gamma_{k}\left(  s\right)  =\left\vert U_{k}\right\vert -\sum
_{\substack{P,Q\subseteq V\text{ nonempty;}\\V=P\sqcup Q}}\left\vert \left\{
B\in U_{k}\ \mid\ S\left(  B\right)  =P\right\}  \right\vert .
\]

\end{lemma}

\begin{proof}
Each $B\in U_{k}$ satisfies $S\left(  B\right)  =P$ for some nonempty subset
$P$ of $V$ (indeed, the set $S\left(  B\right)  $ is nonempty since it
contains $s$). Hence, by the sum rule,%
\begin{align*}
\left\vert U_{k}\right\vert  &  =\sum_{\substack{P,Q\subseteq V;\\P\text{ is
nonempty;}\\V=P\sqcup Q}}\left\vert \left\{  B\in U_{k}\ \mid\ S\left(
B\right)  =P\right\}  \right\vert \\
&  =\sum_{\substack{P,Q\subseteq V\text{ are nonempty;}\\V=P\sqcup
Q}}\left\vert \left\{  B\in U_{k}\ \mid\ S\left(  B\right)  =P\right\}
\right\vert +\left\vert \underbrace{\left\{  B\in U_{k}\ \mid\ S\left(
B\right)  =V\right\}  }_{=\Gamma_{k}\left(  s\right)  }\right\vert \\
&  \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{here, we have split off the addend}\\
\text{for }\left(  P,Q\right)  =\left(  V,\varnothing\right)  \text{ from the
sum}%
\end{array}
\right) \\
&  =\sum_{\substack{P,Q\subseteq V\text{ are nonempty;}\\V=P\sqcup
Q}}\left\vert \left\{  B\in U_{k}\ \mid\ S\left(  B\right)  =P\right\}
\right\vert +\underbrace{\left\vert \Gamma_{k}\left(  s\right)  \right\vert
}_{=\gamma_{k}\left(  s\right)  }\\
&  =\sum_{\substack{P,Q\subseteq V\text{ are nonempty;}\\V=P\sqcup
Q}}\left\vert \left\{  B\in U_{k}\ \mid\ S\left(  B\right)  =P\right\}
\right\vert +\gamma_{k}\left(  s\right)  .
\end{align*}
Solving this for $\gamma_{k}\left(  s\right)  $, we obtain the claim of the lemma.
\end{proof}

Similarly, we find:

\begin{lemma}
\label{lem.new2}We have%
\[
\gamma_{k}\left(  t\right)  =\left\vert U_{k}\right\vert -\sum
_{\substack{P,Q\subseteq V\text{ nonempty;}\\V=P\sqcup Q}}\left\vert \left\{
B\in U_{k}\ \mid\ T\left(  B\right)  =Q\right\}  \right\vert .
\]

\end{lemma}

\begin{proof}
Analogous to the proof of Lemma \ref{lem.new1}. (Just switch the roles of $s$
and $t$ and also the roles of $P$ and $Q$.)
\end{proof}

Our goal is to prove $\gamma_{k}\left(  s\right)  =\gamma_{k}\left(  t\right)
$. In light of Lemma \ref{lem.new1} and Lemma \ref{lem.new2}, it will enough
to show the following:

\begin{proposition}
\label{prop.new3}Let $P$ and $Q$ be two nonempty subsets of $V$ such that
$V=P\sqcup Q$. Then,%
\[
\left\vert \left\{  B\in U_{k}\ \mid\ S\left(  B\right)  =P\right\}
\right\vert =\left\vert \left\{  B\in U_{k}\ \mid\ T\left(  B\right)
=Q\right\}  \right\vert .
\]

\end{proposition}

The way we will prove this is by finding a symmetric expression for both
sides, namely:

\begin{definition}
If $P$ and $Q$ are two subsets of $V$ satisfying $V=P\sqcup Q$, and if
$i\in\mathbb{Z}$ is arbitrary, then we set%
\[
X_{i}^{P,Q}:=\left\{  B\in\mathcal{P}_{i}(A)\text{ is acyclic}\mid
S(B)=P\text{ and }T(B)=Q\right\}  .
\]

\end{definition}

\begin{lemma}
\label{lem.new4}Let $P$ and $Q$ be two nonempty subsets of $V$ such that
$V=P\sqcup Q$. Then,%
\[
\left\vert \left\{  B\in U_{k}\ \mid\ S\left(  B\right)  =P\right\}
\right\vert =\sum_{m=0}^{k}\dbinom{\left\vert A\left(  P,Q\right)  \right\vert
}{m}\cdot\left\vert X_{k-m}^{P,Q}\right\vert .
\]

\end{lemma}

\begin{proof}
Let us first note that $X_{i}^{P,Q}=\varnothing$ for all negative $i$, since
$\mathcal{P}_{i}\left(  A\right)  =\varnothing$ for negative $i$. Thus, in the
sum%
\[
\sum_{m=0}^{k}\dbinom{\left\vert A\left(  P,Q\right)  \right\vert }{m}%
\cdot\left\vert X_{k-m}^{P,Q}\right\vert ,
\]
we can replace the $\sum_{m=0}^{k}$ sign by a $\sum_{m\in\mathbb{N}}$ without
changing the value of the sum.

By the sum rule,
\begin{align}
&  \left\vert \left\{  B\in U_{k}\ \mid\ S\left(  B\right)  =P\right\}
\right\vert \nonumber\\
&  =\sum_{C\subseteq A\left(  P,Q\right)  }\left\vert \left\{  B\in
U_{k}\ \mid\ S\left(  B\right)  =P\text{ and }B\cap A\left(  P,Q\right)
=C\right\}  \right\vert , \label{pf.lem.new4.sum}%
\end{align}
since the intersection $B\cap A\left(  P,Q\right)  $ is always a subset of
$A\left(  P,Q\right)  $.

Fix a subset $C\subseteq A(P,Q)$, and let
\[
Y_{k}:=\left\{  B\in U_{k}\ \mid\ S\left(  B\right)  =P\text{ and }B\cap
A\left(  P,Q\right)  =C\right\}  .
\]
We want to show that $\left\vert Y_{k}\right\vert =\left\vert X_{k-|C|}%
^{P,Q}\right\vert $. Define the maps
\begin{align*}
\Phi:Y_{k}  &  \rightarrow X_{k-|C|}^{P,Q},\\
\Phi(B)  &  =B\setminus C
\end{align*}
and
\begin{align*}
\Psi:X_{k-|C|}^{P,Q}  &  \rightarrow Y_{k},\\
\Psi(E)  &  =E\cup C.
\end{align*}
Let us first show that these maps are well-defined:

\begin{statement}
\textit{Claim 1.} $\Phi$ is well-defined. That is, $B\setminus C\in
X_{k-|C|}^{P,Q}$ for all $B\in Y_{k}$.
\end{statement}

\begin{proof}
[Proof of Claim 1.]Let $B\in Y_{k}$. Then $B$ is an acyclic $k$-element subset
of $A$, and each vertex can $B$-reach $s$ or $B$-reach $t$, and we have
$S(B)=P$ and $B\cap A(P,Q)=C$.

We must show that $B\setminus C\in X_{k-|C|}^{P,Q}$. In other words, we must
show that $B\setminus C$ is an acyclic set in $\mathcal{P}_{k-\left\vert
C\right\vert }\left(  A\right)  $ and satisfies $S\left(  B\setminus C\right)
=P$ and $T\left(  B\setminus C\right)  =Q$.

It is clear that $B\setminus C$ is acyclic, since removing arcs from the
acyclic set $B$ cannot create any cycles.

Moreover, from $C=B\cap A\left(  P,Q\right)  \subseteq B$, we obtain
\[
\left\vert B\setminus C\right\vert =\underbrace{\left\vert B\right\vert }%
_{=k}-\left\vert C\right\vert =k-\left\vert C\right\vert .
\]
Thus, $B\setminus C\in\mathcal{P}_{k-\left\vert C\right\vert }\left(
A\right)  $.

Note also that%
\[
B\setminus A\left(  P,Q\right)  =B\setminus\underbrace{\left(  B\cap
A(P,Q)\right)  }_{=C}=B\setminus C.
\]
Thus, the set $B\setminus C$ is disjoint from $A\left(  P,Q\right)  $.

Next we show that $B\cap A\left(  Q,P\right)  =\varnothing$. Indeed, assume
the contrary. Then, there is an arc $b\in B$ with source $q\in Q$ and target
$p\in P$. The vertex $p$ can $B$-reach $s$ (since $p\in P=S\left(  B\right)
$), so the vertex $q$ can $B$-reach as well (by first stepping to $p$ via the
arc $b$). This means that $q\in S\left(  B\right)  =P$, which contradicts
$q\in Q$ since $P\sqcup Q=V$. This contradiction shows that our assumption was
false, so we know that $B\cap A\left(  Q,P\right)  =\varnothing$.

In other words, no arc in $B$ belongs to $A\left(  Q,P\right)  $. Hence, no
arc in $B\setminus C$ belongs to $A\left(  Q,P\right)  $ either (since
$B\setminus C\subseteq B$). Furthermore, no arc in $B\setminus C$ belongs to
$A\left(  P,Q\right)  $ (since the set $B\setminus C$ is disjoint from
$A\left(  P,Q\right)  $).

Let us now prove that $S\left(  B\setminus C\right)  =P$. From $B\setminus
C\subseteq B$, we clearly obtain $S\left(  B\setminus C\right)  \subseteq
S\left(  B\right)  =P$, so we must show the converse. Let $p\in P$. Then, $p$
can $B$-reach $s$ (since $p\in P=S\left(  B\right)  $). That is, the digraph
$D\left\langle B\right\rangle $ contains a path from $p$ to $s$. Moreover, any
vertex $v$ of this path must itself belong to $S\left(  B\right)  $ (since it
can $B$-reach $s$ through a portion of this path), so it cannot belong to $Q$
(since $S\left(  B\right)  =P$ is disjoint from $Q$). Therefore, no arc of
this path can belong to $A\left(  P,Q\right)  $. Thus, all arcs of this path
belong to $B\setminus A\left(  P,Q\right)  =B\setminus C$. This path is
therefore a path of $D\left\langle B\setminus C\right\rangle $. Consequently,
the vertex $p$ can $B\setminus C$-reach $s$. In other words, $p\in S\left(
B\setminus C\right)  $. Since we have proved this for each $p\in P$, we
conclude that $P\subseteq S\left(  B\setminus C\right)  $. Therefore,
$S\left(  B\setminus C\right)  =P$ (since $S\left(  B\setminus C\right)
\subseteq P$).

It remains to show that $T\left(  B\setminus C\right)  =Q$.

First, we claim that $t\in Q$. Indeed, there exists some vertex $v\in Q$
(since $Q$ is nonempty). Consider this $v$. From $v\in Q$ and $P\sqcup Q=V$,
we obtain $v\notin P=S\left(  B\right)  $, and thus $v$ cannot $B$-reach $s$.
Hence, $v$ can $B$-reach $t$ (since each vertex can $B$-reach $s$ or $B$-reach
$t$). If $t$ could $B$-reach $s$, then this would entail that $v$ can also
$B$-reach $s$ (by concatenating the path from $v$ to $t$ and the path from $t$
to $s$), and this would contradict the fact that $v$ cannot $B$-reach $s$.
Hence, $t$ cannot $B$-reach $s$. In other words, $t\notin S\left(  B\right)
=P$, so that $t\in Q$ (since $P\sqcup Q=V$).

Let us now prove that $T\left(  B\setminus C\right)  \subseteq Q$. Indeed, let
$x\in T\left(  B\setminus C\right)  $ be any vertex. We must show that $x\in
Q$. Assume the contrary. Then, $x\in P$ (since $P\sqcup Q=V$). But $x\in
T\left(  B\setminus C\right)  $ shows that $x$ can $B\setminus C$-reach $t$.
So the digraph $D\left\langle B\setminus C\right\rangle $ has a path from $x$
to $t$. This path starts at a vertex in $P$ (namely, $x\in P$) and ends at a
vertex in $Q$ (namely, $t\in Q$). So it must cross from $P$ to $Q$ at some
point. In other words, it must contain an arc that belongs to $A\left(
P,Q\right)  $. But this is impossible, since all its arcs come from the set
$B\setminus C$, which is disjoint from $A\left(  P,Q\right)  $. This
contradiction shows that $x\in Q$. Since we have proved this for each $x\in
T\left(  B\setminus C\right)  $, we thus conclude that $T\left(  B\setminus
C\right)  \subseteq Q$.

Now, we claim that $Q\subseteq T\left(  B\setminus C\right)  $. Indeed, let
$q\in Q$ be any vertex. Then, $q\notin P$ (since $P\sqcup Q=V$), so that
$q\notin P=S\left(  B\right)  $. In other words, $q$ cannot $B$-reach $s$.
Hence, $q$ can $B$-reach $t$ (since each vertex can $B$-reach $s$ or $B$-reach
$t$). That is, the digraph $D\left\langle B\right\rangle $ has a path from $q$
to $t$. Any vertex $w$ of this path must itself belong to $Q$ (since
otherwise, $w$ would belong to $P=S\left(  B\right)  $ and thus could
$B$-reach $s$, so that the vertex $q$ could also $B$-reach $s$ by first
following the path from $q$ to $t$ until $w$ and then following the path from
$w$ to $s$). Therefore, no arc of this path can belong to $A\left(
P,Q\right)  $ (since the source of such an arc would lie in $P$ rather than
$Q$). Thus, all arcs of this path belong to $B\setminus A\left(  P,Q\right)
=B\setminus C$, so this path is a path of $D\left\langle B\setminus
C\right\rangle $. This shows that $q$ can $B\setminus C$-reach $t$. In other
words, $q\in T\left(  B\setminus C\right)  $. Since we have proved this for
each $q\in Q$, we thus conclude that $Q\subseteq T\left(  B\setminus C\right)
$.

Combining this with $T\left(  B\setminus C\right)  \subseteq Q$, we obtain
$Q=T\left(  B\setminus C\right)  $.

Altogether, we now have shown that $B\setminus C$ is an acyclic set in
$\mathcal{P}_{k-\left\vert C\right\vert }\left(  A\right)  $ and satisfies
$S\left(  B\setminus C\right)  =P$ and $T\left(  B\setminus C\right)  =Q$. In
other words, $B\setminus C\in X_{k-\left\vert C\right\vert }^{P,Q}$. Claim 1
is thus proved.
\end{proof}

\begin{statement}
\textit{Claim 2.} $\Psi$ is well-defined. That is, $E\cup C\in Y_{k}$ for all
$E\in X_{k-|C|}^{P,Q}$.
\end{statement}

\begin{proof}
[Proof of Claim 2.]Let $E\in X_{k-|C|}^{P,Q}$. Then $E$ is an acyclic $\left(
k-\left\vert C\right\vert \right)  $-element subset of $A$ satisfying
$S\left(  E\right)  =P$ and $T\left(  E\right)  =Q$.

We must show that $E\cup C\in Y_{k}$. In other words, we must show that $E\cup
C\in U_{k}$ and $S\left(  E\cup C\right)  =P$ and $\left(  E\cup C\right)
\cap A\left(  P,Q\right)  =C$.

First, we show that $E\cap A\left(  P,Q\right)  =\varnothing$. Indeed, assume
the contrary. Then, there exists some arc $d\in E\cap A\left(  P,Q\right)  $.
Thus, $d\in E$ and $d\in A\left(  P,Q\right)  $, so that $d$ has a source
$p\in P$ and a target $q\in Q$. From $q\in Q=T\left(  E\right)  $, we see that
$q$ can $E$-reach $t$. Thus, $p$ can also $E$-reach $t$ (via the arc $d\in E$
followed by the path from $q$ to $t$). Therefore, $p\in T\left(  E\right)
=Q$, which contradicts $p\in P$ because $P\sqcup Q=V$. This contradiction
shows that our assumption was false. Hence, $E\cap A\left(  P,Q\right)
=\varnothing$ is proved.

An analogous argument shows that $E\cap A\left(  Q,P\right)  =\varnothing$.
Note that the sets $A\left(  P,Q\right)  $ and $A\left(  Q,P\right)  $ are
disjoint, since the source of an arc cannot belong to $P$ and $Q$ at the same
time ($P\sqcup Q=V$).

Note that $C$ is a subset of $A\left(  P,Q\right)  $, and thus we have
$E\cap\underbrace{C}_{\subseteq A\left(  P,Q\right)  }\subseteq E\cap A\left(
P,Q\right)  =\varnothing$. Hence,
\begin{equation}
E\cap C=\varnothing, \label{pf.lem.new4.c2.pf.empty}%
\end{equation}
so that%
\[
\left\vert E\cup C\right\vert =\left\vert E\right\vert +\left\vert
C\right\vert =k\ \ \ \ \ \ \ \ \ \ \left(  \text{since }\left\vert
E\right\vert =k-\left\vert C\right\vert \right)  .
\]
Therefore, $E\cup C\in\mathcal{P}_{k}\left(  A\right)  $.

Next, we show that $E\cup C$ is acyclic. Indeed, assume the contrary. Then,
the digraph $D\left\langle E\cup C\right\rangle $ has a cycle $\mathbf{c}$.
Since $E$ itself is acyclic, this cycle $\mathbf{c}$ must use at least one arc
from $C$. This arc must have source in $P$ and target in $Q$ (because it
belongs to $C\subseteq A\left(  P,Q\right)  $). Thus, the cycle $\mathbf{c}$
contains both a vertex in $P$ and a vertex in $Q$. Consequently, it must cross
from $Q$ to $P$ at some point. In other words, it contains an arc $a\in
A\left(  Q,P\right)  $. But such an arc $a$ cannot belong to $E$ (since $E\cap
A\left(  Q,P\right)  =\varnothing$), and cannot belong to $C$ either (since
$C$ is a subset of $A\left(  P,Q\right)  $, which is disjoint from $A\left(
Q,P\right)  $). Hence, it cannot belong to $E\cup C$. This is a contradiction,
since it is an arc of $\mathbf{c}$, which is a cycle of $D\left\langle E\cup
C\right\rangle $. This contradiction shows that our assumption was wrong, so
$E\cup C$ is indeed acyclic.

Next, from $E\subseteq E\cup C$, we obtain $S\left(  E\right)  \subseteq
S\left(  E\cup C\right)  $, whence $P=S\left(  E\right)  \subseteq S\left(
E\cup C\right)  $.

Now we shall show that $S\left(  E\cup C\right)  =P$. Indeed, assume the
contrary. Thus, $P$ is a \textbf{proper} subset of $S\left(  E\cup C\right)  $
(since $P\subseteq S\left(  E\cup C\right)  $). Hence, there exists a vertex
$v\in S\left(  E\cup C\right)  $ that does not belong to $P$. Consider this
$v$. From $v\in S\left(  E\cup C\right)  $, we know that $v$ can $E\cup
C$-reach $s$. In other words, the digraph $D\left\langle E\cup C\right\rangle
$ has a path $\mathbf{p}$ from $v$ to $s$. But $v$ cannot $E$-reach $s$ (since
$v\notin P=S\left(  E\right)  $). Hence, the path $\mathbf{p}$ from $v$ to $s$
cannot be a path of $D\left\langle E\right\rangle $. Thus, $\mathbf{p}$ must
contain some arc $c\notin E$. Pick the \textbf{last} such arc $c$ on
$\mathbf{p}$. This arc $c$ must then belong to $C$ (since $c\in E\cup C$ but
$c\notin E$). Hence, $c\in C\subseteq A\left(  P,Q\right)  $, so that the
source of $c$ belongs to $P$ and the target of $c$ belongs to $Q$. Let $p$ be
the source of $c$, and let $q$ be the target of $c$; thus, $p\in P$ and $q\in
Q$.

Note that $c$ is the \textbf{last} arc of $\mathbf{p}$ that does not belong to
$E$. Hence, all arcs of $\mathbf{p}$ after $c$ do belong to $E$, thus are arcs
of $D\left\langle E\right\rangle $. Therefore, $q$ can $E$-reach $s$ (by
walking along the path $\mathbf{p}$ from $q$ onwards). In other words, $q\in
S\left(  E\right)  =P$. But this contradicts $q\in Q$, since $P\sqcup Q=V$. So
our assumption was wrong, and we have proved that $S\left(  E\cup C\right)
=P$.

Each vertex in $P$ can $E$-reach $s$ (since it lies in $P=S\left(  E\right)
$) and thus can $E\cup C$-reach $s$ as well (since $E\subseteq E\cup C$). Each
vertex in $Q$ can $E$-reach $t$ (since it lies in $Q=T\left(  E\right)  $) and
thus can $E\cup C$-reach $t$ as well (since $E\subseteq E\cup C$). Since each
vertex in $V$ belongs to either $P$ or $Q$, we thus conclude that each vertex
in $V$ can $E\cup C$-reach $s$ or can $E\cup C$-reach $t$. This shows that
$E\cup C\in U_{k}$ (since $E\cup C\in\mathcal{P}_{k}\left(  A\right)  $ is acyclic).

It remains to show that $\left(  E\cup C\right)  \cap A\left(  P,Q\right)
=C$. But this follows from%
\begin{align*}
&  \left(  E\cup C\right)  \cap A\left(  P,Q\right) \\
&  =\underbrace{\left(  E\cap A\left(  P,Q\right)  \right)  }_{=\varnothing
}\cup\underbrace{\left(  C\cap A\left(  P,Q\right)  \right)  }%
_{\substack{=C\\\text{(since }C\subseteq A\left(  P,Q\right)  \text{)}%
}}=\varnothing\cup C=C.
\end{align*}


So we have shown that $E\cup C\in U_{k}$ and $S\left(  E\cup C\right)  =P$ and
$\left(  E\cup C\right)  \cap A\left(  P,Q\right)  =C$. All together, this
yields $E\cup C\in Y_{k}$.
\end{proof}

\begin{statement}
\textit{Claim 3.} The maps $\Phi$ and $\Psi$ are mutually inverse.
\end{statement}

\begin{proof}
[Proof of Claim 3.]For each $B\in Y_{k}$, we have $B\cap A\left(  P,Q\right)
=C$ and therefore $C=B\cap A\left(  P,Q\right)  \subseteq B$. Thus, for each
$B\in Y_{k}$, we have%
\[
\Psi\left(  \Phi\left(  B\right)  \right)  =\Psi\left(  B\setminus C\right)
=\left(  B\setminus C\right)  \cup C=B\ \ \ \ \ \ \ \ \ \ \left(  \text{since
}C\subseteq B\right)  .
\]
In other words, $\Psi\circ\Phi=\operatorname*{id}$.

On the other hand, for each $E\in X_{k-|C|}^{P,Q}$, we have $E\cap
C=\varnothing$ (see the equality (\ref{pf.lem.new4.c2.pf.empty}) in the proof
of Claim 2) and thus%
\[
\Phi\left(  \Psi\left(  E\right)  \right)  =\Phi\left(  E\cup C\right)
=\left(  E\cup C\right)  \setminus C=E\ \ \ \ \ \ \ \ \ \ \left(  \text{since
}E\cap C=\varnothing\right)  .
\]
This shows that $\Phi\circ\Psi=\operatorname*{id}$.

From $\Phi\circ\Psi=\operatorname*{id}$ and $\Psi\circ\Phi=\operatorname*{id}%
$, we conclude that the maps $\Phi$ and $\Psi$ are mutually inverse. This
proves Claim 3.
\end{proof}

Claim 3 shows that the map $\Phi$ is a bijection from $X_{k-|C|}^{P,Q}$ to
$Y_{k}$. Thus,%
\[
\left\vert X_{k-|C|}^{P,Q}\right\vert =\left\vert Y_{k}\right\vert =\left\vert
\left\{  B\in U_{k}\ \mid\ S\left(  B\right)  =P\text{ and }B\cap A\left(
P,Q\right)  =C\right\}  \right\vert
\]
(by the definition of $Y_{k}$).

We have proved this equality for each subset $C$ of $A\left(  P,Q\right)  $.
Summing it over all such subsets, we obtain%
\begin{align*}
\sum_{C\subseteq A\left(  P,Q\right)  }\left\vert X_{k-|C|}^{P,Q}\right\vert
&  =\sum_{C\subseteq A\left(  P,Q\right)  }\left\vert \left\{  B\in
U_{k}\ \mid\ S\left(  B\right)  =P\text{ and }B\cap A\left(  P,Q\right)
=C\right\}  \right\vert \\
&  =\left\vert \left\{  B\in U_{k}\ \mid\ S\left(  B\right)  =P\right\}
\right\vert \ \ \ \ \ \ \ \ \ \ \left(  \text{by (\ref{pf.lem.new4.sum}%
)}\right)  .
\end{align*}
Thus,%
\begin{align*}
&  \left\vert \left\{  B\in U_{k}\ \mid\ S\left(  B\right)  =P\right\}
\right\vert \\
&  =\sum_{C\subseteq A\left(  P,Q\right)  }\left\vert X_{k-|C|}^{P,Q}%
\right\vert =\sum_{m\in\mathbb{N}}\ \ \sum_{\substack{C\subseteq A\left(
P,Q\right)  ;\\\left\vert C\right\vert =m}}\underbrace{\left\vert
X_{k-|C|}^{P,Q}\right\vert }_{\substack{=\left\vert X_{k-m}^{P,Q}\right\vert
\\\text{(since }\left\vert C\right\vert =m\text{)}}}\\
&  =\sum_{m\in\mathbb{N}}\ \ \underbrace{\sum_{\substack{C\subseteq A\left(
P,Q\right)  ;\\\left\vert C\right\vert =m}}\left\vert X_{k-m}^{P,Q}\right\vert
}_{\substack{=\dbinom{\left\vert A\left(  P,Q\right)  \right\vert }{m}%
\cdot\left\vert X_{k-m}^{P,Q}\right\vert \\\text{(since this sum has }%
\dbinom{\left\vert A\left(  P,Q\right)  \right\vert }{m}\\\text{many equal
addends)}}}=\sum_{m\in\mathbb{N}}\dbinom{\left\vert A\left(  P,Q\right)
\right\vert }{m}\cdot\left\vert X_{k-m}^{P,Q}\right\vert \\
&  =\sum_{m=0}^{k}\dbinom{\left\vert A\left(  P,Q\right)  \right\vert }%
{m}\cdot\left\vert X_{k-m}^{P,Q}\right\vert
\end{align*}
(here, we have restricted the sum to $m\leq k$, because each $m>k$ satisfies
$\left\vert X_{k-m}^{P,Q}\right\vert =0$). This proves Lemma \ref{lem.new4}.
\end{proof}

\begin{lemma}
\label{lem.new5} Let $P$ and $Q$ be two nonempty subsets of $V$ such that
$V=P\sqcup Q$. Then,%
\[
\left\vert \left\{  B\in U_{k}\ \mid\ T\left(  B\right)  =Q\right\}
\right\vert =\sum_{m=0}^{k}\dbinom{\left\vert A\left(  Q,P\right)  \right\vert
}{m}\cdot\left\vert X_{k-m}^{P,Q}\right\vert .
\]

\end{lemma}

\begin{proof}
Analogous to the proof of Lemma \ref{lem.new4}. (Just switch the roles of $s$
and $t$ and also the roles of $P$ and $Q$.)
\end{proof}

\begin{proof}
[Proof of Proposition \ref{prop.new3}.]Lemma \ref{lem.new4} yields%
\begin{align*}
\left\vert \left\{  B\in U_{k}\ \mid\ S\left(  B\right)  =P\right\}
\right\vert  &  =\sum_{m=0}^{k}\dbinom{\left\vert A\left(  P,Q\right)
\right\vert }{m}\cdot\left\vert X_{k-m}^{P,Q}\right\vert \\
&  =\sum_{m=0}^{k}\dbinom{\left\vert A\left(  Q,P\right)  \right\vert }%
{m}\cdot\left\vert X_{k-m}^{P,Q}\right\vert \\
&  \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \left(
\begin{array}
[c]{c}%
\text{since Proposition \ref{prop.A-symmetry}}\\
\text{yields }\left\vert A\left(  P,Q\right)  \right\vert =\left\vert A\left(
Q,P\right)  \right\vert
\end{array}
\right) \\
&  =\left\vert \left\{  B\in U_{k}\ \mid\ T\left(  B\right)  =Q\right\}
\right\vert \ \ \ \ \ \ \ \ \ \ \left(  \text{by Lemma \ref{lem.new5}}\right)
.
\end{align*}

\end{proof}

Thanks to Proposition \ref{prop.new3}, we know that the right hand sides in
Lemma \ref{lem.new1} and Lemma \ref{lem.new2} are equal. Thus, the left hand
sides are equal as well. In other words, $\gamma_{k}\left(  s\right)
=\gamma_{k}\left(  t\right)  $. This completes the proof of Theorem
\ref{thm.balgamma}.

\section{Further remarks on $s$-convergences}

We note the following alternative characterization of $s$-convergences:

\begin{proposition}
Let $B$ be an acyclic subset of $A$. Let $s \in V$. Then, $B$ is an
$s$-convergence if and only if $s$ is the only sink (= vertex with no outgoing
arcs) of the subdigraph $D\left\langle B\right\rangle $.
\end{proposition}

\begin{proof}
$\Longrightarrow$: Assume that $B$ is an $s$-convergence. Thus, $s$ is a
to-root of $D\left\langle B\right\rangle $.

We shall first show that $s$ is a sink of $D\left\langle B\right\rangle $.
Indeed, assume the contrary; thus, there exists an arc $a$ of $D\left\langle
B\right\rangle $ with source $s$. Let $v$ be the target of this arc $a$. Since
$s$ is a to-root of $D\left\langle B\right\rangle $, there exists a path from
$v$ to $s$ in $D\left\langle B\right\rangle $. This path, together with the
arc $a$, creates a directed cycle\footnote{If $v=s$, then this cycle consists
of just a single loop.} in $D\left\langle B\right\rangle $, which contradicts
the acyclicity of $B$. So, we see that $s$ is a sink of $D\left\langle
B\right\rangle $.

Furthermore, no vertex $v\neq s$ can also be a sink of $D\left\langle
B\right\rangle $, for $D\left\langle B\right\rangle $ must have a path from
$v$ to $s$ (because $s$ is a to-root of $D\left\langle B\right\rangle $) and
this path must begin with an arc with source $v$. So we conclude that $s$ is
the only sink of $D\left\langle B\right\rangle $. \medskip

$\Longleftarrow$: Assume that $s$ is the only sink of $D\left\langle
B\right\rangle $. Starting at any vertex $v\in V$ and walking along the
digraph $D\left\langle B\right\rangle $ (that is, following arcs in $B$ from
source to target), we will eventually get stuck at a sink, since otherwise we
would run into a cycle after sufficiently many steps (and this would
contradict the acyclicity of $B$). Since $s$ is the only sink of
$D\left\langle B\right\rangle $, we will thus get stuck at $s$. Hence,
$D\left\langle B\right\rangle $ has a path from $v$ to $s$ (indeed, it is a
path, since $D\left\langle B\right\rangle $ has no cycles). Since $v$ was
arbitrary, this shows that $s$ is a to-root of $D\left\langle B\right\rangle
$. Therefore, $B$ is an $s$-convergence.
\end{proof}

\begin{thebibliography}{99999999}                                                                                         %


\bibitem[22s]{22s}\href{https://arxiv.org/abs/2308.04512v3}{Darij Grinberg,
\textit{An introduction to graph theory}, arXiv:2308.04512v3.}

\bibitem[Foissy22]{Foissy22}%
\href{https://arxiv.org/abs/2201.11974v5}{Lo\"{\i}c Foissy, \textit{Bialgebras
in cointeraction, the antipode and the eulerian idempotent},
arXiv:2201.11974v5.}

\bibitem[GreZas83]{GreZas83}%
\href{https://doi.org/10.1090/S0002-9947-1983-0712251-1}{Curtis Greene, Thomas
Zaslavsky, \textit{On the interpretation of Whitney numbers through
arrangement of hyperplanes, zonotopes, non-Radon partitions, and orientations
of graphs}. Trans. Amer. Math. Soc. \textbf{280}(1) (1983), pp. 97--126.}

\bibitem[LeiVal24]{LeiVal24}\href{https://arxiv.org/abs/2402.09914v3}{Karla
Leipold, Frank Vallentin, \textit{Computing the EHZ capacity is NP-hard},
arXiv:2402.09914v3.}

\bibitem[PerPha15]{PerPha15}K\'{e}vin Perrot, Trung Van Pham, \textit{Feedback
Arc Set Problem and NP-Hardness of Minimum Recurrent Configuration Problem of
Chip-Firing Game on Directed Graphs}, Annals of Combinatorics \textbf{19}
(2015), pages 373--396.
\end{thebibliography}


\end{document}